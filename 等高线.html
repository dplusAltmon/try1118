<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数据可视化综合展示</title>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #2a4d69, #4b86b4);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 20px;
        }
        
        h1 {
            font-size: 3.2rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .tabs {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .tab-btn {
            padding: 12px 25px;
            background: rgba(255, 255, 255, 0.15);
            border: none;
            border-radius: 30px;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            min-width: 200px;
        }
        
        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-3px);
        }
        
        .tab-btn.active {
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            box-shadow: 0 4px 15px rgba(255, 126, 95, 0.4);
        }
        
        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .chart-header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .chart-header h2 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: #ffb347;
        }
        
        .chart-header p {
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
            opacity: 0.85;
        }
        
        .chart-container {
            height: 500px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 15px;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            gap: 10px;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 12px 20px;
            border-radius: 50px;
        }
        
        .control-group label {
            font-size: 1rem;
        }
        
        select, button {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 30px;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        select:hover, button:hover {
            background: rgba(255, 255, 255, 0.25);
        }
        
        select:focus, button:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(255, 126, 95, 0.5);
        }
        
        .image-container {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .image-box {
            text-align: center;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 15px;
            width: 45%;
            min-width: 300px;
        }
        
        .image-box h3 {
            margin-bottom: 15px;
            color: #ffb347;
        }
        
        .image-box img {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .data-table th, .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .data-table th {
            background: rgba(255, 179, 71, 0.2);
            font-weight: 600;
        }
        
        .data-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        @media (max-width: 768px) {
            .image-box {
                width: 100%;
            }
            
            .tabs {
                flex-direction: column;
                align-items: center;
            }
            
            .tab-btn {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>数据可视化综合展示</h1>
            <p class="subtitle">本页面展示了多种数据可视化技术：火山等高线图、图像灰度等高线、Iris数据密度图、多维数据密度图和动态直方图</p>
        </header>
        
        <div class="tabs">
            <button class="tab-btn active" data-tab="volcano">火山等高线图</button>
            <button class="tab-btn" data-tab="image">图像灰度等高线</button>
            <button class="tab-btn" data-tab="iris">Iris数据密度图</button>
            <button class="tab-btn" data-tab="multi">多维数据密度图</button>
            <button class="tab-btn" data-tab="histogram">动态直方图</button>
        </div>
        
        <!-- 火山等高线图 -->
        <div id="volcano-tab" class="tab-content active">
            <div class="chart-header">
                <h2>火山地形等高线图</h2>
                <p>使用火山高程数据绘制的等高线图，展示了地形的高低变化。等高线越密集表示地形越陡峭，越稀疏表示地形越平缓。</p>
            </div>
            <div id="volcano-chart" class="chart-container"></div>
        </div>
        
        <!-- 图像灰度等高线 -->
        <div id="image-tab" class="tab-content">
            <div class="chart-header">
                <h2>图像灰度等高线图</h2>
                <p>将彩色图像转换为灰度图，然后根据灰度值绘制等高线图。这可以用于分析图像的亮度分布特征。</p>
            </div>
            <div class="controls">
                <div class="control-group">
                    <label for="image-select">选择图像：</label>
                    <select id="image-select">
                        <option value="mountain">山脉</option>
                        <option value="valley">山谷</option>
                        <option value="lake">湖泊</option>
                    </select>
                </div>
                <button id="generate-contour">生成等高线</button>
            </div>
            <div class="image-container">
                <div class="image-box">
                    <h3>原始图像</h3>
                    <img id="original-image" src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=500" alt="原始图像">
                </div>
                <div class="image-box">
                    <h3>等高线图</h3>
                    <div id="image-contour" class="chart-container"></div>
                </div>
            </div>
        </div>
        
        <!-- Iris数据密度图 -->
        <div id="iris-tab" class="tab-content">
            <div class="chart-header">
                <h2>Iris数据集密度分布图</h2>
                <p>展示鸢尾花数据集中不同品种的花萼长度与花萼宽度的密度分布。每种颜色代表一个品种，等高线表示数据点的密度。</p>
            </div>
            <div id="iris-chart" class="chart-container"></div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>花萼长度</th>
                        <th>花萼宽度</th>
                        <th>花瓣长度</th>
                        <th>花瓣宽度</th>
                        <th>品种</th>
                    </tr>
                </thead>
                <tbody id="iris-data">
                    <!-- 数据将通过JS填充 -->
                </tbody>
            </table>
        </div>
        
        <!-- 多维数据密度图 -->
        <div id="multi-tab" class="tab-content">
            <div class="chart-header">
                <h2>多维数据密度图</h2>
                <p>从多维数据中选择任意两个维度，绘制它们的联合密度分布图。可以用于探索不同变量之间的关系。</p>
            </div>
            <div class="controls">
                <div class="control-group">
                    <label for="x-dimension">X 轴：</label>
                    <select id="x-dimension">
                        <option value="gdp">GDP (万亿美元)</option>
                        <option value="population">人口 (百万人)</option>
                        <option value="area">面积 (万平方公里)</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="y-dimension">Y 轴：</label>
                    <select id="y-dimension">
                        <option value="population">人口 (百万人)</option>
                        <option value="gdp">GDP (万亿美元)</option>
                        <option value="area">面积 (万平方公里)</option>
                    </select>
                </div>
                <button id="update-density">更新图表</button>
            </div>
            <div id="multi-chart" class="chart-container"></div>
        </div>
        
        <!-- 动态直方图 -->
        <div id="histogram-tab" class="tab-content">
            <div class="chart-header">
                <h2>动态直方图</h2>
                <p>展示随时间变化的房价数据直方图。动画显示了10年间房价分布的变化情况。</p>
            </div>
            <div class="controls">
                <button id="play-btn">播放动画</button>
                <button id="pause-btn">暂停</button>
                <button id="reset-btn">重置</button>
            </div>
            <div id="histogram-chart" class="chart-container"></div>
        </div>
        
        <footer>
            <p>数据可视化综合展示 | 使用 JavaScript/HTML/CSS 实现 | 22计传张颖惠</p>
        </footer>
    </div>
    
    <script>
        // 标签切换功能
        document.querySelectorAll('.tab-btn').forEach(button => {
            button.addEventListener('click', () => {
                // 移除所有活动状态
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // 添加当前活动状态
                button.classList.add('active');
                const tabId = button.getAttribute('data-tab');
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });
        
        // 火山数据
        const volcanoData = {
            width: 87,
            height: 61,
            values: [
                103,104,104,105,105,106,106,106,107,107,106,106,105,105,104,104,104,104,105,107,107,106,105,105,107,108,109,110,110,110,110,110,110,109,109,109,109,109,109,108,107,107,107,107,106,106,105,104,104,104,104,104,104,104,103,103,103,103,102,102,101,101,100,100,100,100,100,99,98,97,97,96,96,96,96,96,96,96,95,95,95,94,94,94,94,94,94,
                104,104,105,105,106,106,107,107,107,107,107,107,107,106,106,106,106,106,106,108,108,108,106,106,108,109,110,110,112,112,113,112,111,110,110,110,110,109,109,109,108,107,107,107,107,106,106,105,104,104,104,104,104,104,104,103,103,103,103,102,102,101,101,100,100,100,100,99,99,98,97,97,96,96,96,96,96,96,96,95,95,95,94,94,94,94,94,
                104,105,105,106,106,107,107,108,108,108,108,108,108,108,108,108,108,108,108,108,110,110,110,110,110,110,110,111,113,115,116,115,113,112,110,110,110,110,110,110,109,108,108,108,108,107,106,105,105,105,105,105,105,104,104,104,104,103,103,103,102,102,102,101,100,100,100,99,99,98,97,97,96,96,96,96,96,96,96,96,95,95,94,94,94,94,94,
                105,105,106,106,107,107,108,108,109,109,109,109,109,110,110,110,110,110,110,110,111,112,115,115,115,115,115,116,116,117,119,118,117,116,114,113,112,110,110,110,110,110,110,109,109,108,107,106,106,106,106,106,105,105,105,104,104,104,103,103,103,102,102,102,101,100,100,99,99,98,97,97,96,96,96,96,96,96,96,96,95,95,94,94,94,94,94,
                105,106,106,107,107,108,108,109,109,110,110,110,110,111,110,110,110,110,111,114,115,116,121,121,121,121,121,122,123,124,124,123,121,119,118,117,115,114,112,111,110,110,110,110,110,110,109,109,108,109,107,107,106,106,105,105,104,104,104,104,103,103,102,102,102,101,100,100,99,99,98,97,96,96,96,96,96,96,96,96,95,95,94,94,94,94,94,
                106,106,107,107,107,108,109,109,110,110,111,111,112,113,112,111,111,112,115,118,118,119,126,128,128,127,128,128,129,130,129,128,127,125,122,120,118,117,115,114,112,110,110,110,110,110,111,110,110,110,109,109,108,107,106,105,105,105,104,104,104,103,103,102,102,102,101,100,99,99,98,97,96,96,96,96,96,96,96,96,95,95,94,94,94,94,94,
                106,107,107,108,108,108,109,110,110,111,112,113,114,115,114,115,116,116,119,123,125,130,133,134,134,134,134,135,135,136,135,134,132,130,128,124,121,119,118,116,114,112,111,111,111,112,112,111,110,110,110,109,108,108,107,108,107,106,105,104,104,104,103,103,103,102,101,100,99,99,98,97,96,96,96,96,96,96,96,96,95,95,95,94,94,94,94,
                107,107,108,108,109,109,110,110,112,113,114,115,116,117,117,120,120,121,123,129,134,136,138,139,139,139,140,142,142,141,141,140,137,134,131,127,124,122,120,118,117,115,113,114,113,114,114,113,112,111,110,110,109,108,107,106,105,105,105,104,104,104,103,103,103,101,100,100,99,99,98,97,96,96,96,96,96,96,96,96,96,95,95,94,94,94,94,
                107,108,108,109,109,110,111,112,114,115,116,117,118,119,121,125,125,127,131,136,140,141,142,144,144,145,148,149,148,147,146,144,140,138,136,130,127,125,123,121,119,118,117,117,116,116,116,115,114,113,113,111,110,109,108,107,106,105,105,103,103,102,102,102,103,101,100,100,100,99,98,98,97,96,96,96,96,96,96,96,96,95,95,95,94,94,94,
                107,108,109,109,110,110,110,113,115,117,118,119,120,123,126,129,131,134,139,142,144,145,147,148,150,152,154,154,153,154,151,149,146,143,140,136,130,128,126,124,122,121,120,119,118,117,117,117,116,116,115,113,112,110,109,108,107,106,106,105,104,103,102,101,101,100,100,100,100,99,99,98,97,96,96,96,96,96,96,96,96,95,95,95,94,94,94,
                107,108,109,109,110,110,110,112,115,117,119,122,125,127,130,133,137,141,143,145,148,149,152,155,157,159,160,160,161,162,159,156,153,149,146,142,139,134,130,128,126,125,122,120,120,120,119,119,119,118,117,115,113,111,110,110,109,108,107,106,106,105,104,104,103,102,100,100,100,99,99,98,97,96,96,96,96,96,96,96,96,95,95,95,95,94,94,
                108,108,109,109,110,110,110,112,115,118,121,125,128,131,134,138,141,145,147,149,152,157,160,161,163,166,169,170,170,171,168,162,158,155,152,148,144,140,136,132,129,127,124,122,121,120,120,120,120,120,119,117,115,113,110,110,110,110,109,108,108,107,107,106,105,104,102,100,100,100,99,98,97,96,96,96,96,96,96,96,96,96,95,95,95,94,94,
                108,109,109,110,110,111,112,114,117,120,124,128,131,135,138,142,145,149,152,155,158,163,166,167,170,173,175,175,175,173,171,169,164,160,156,153,149,144,140,136,131,129,126,124,123,123,122,121,120,120,120,119,117,115,111,110,110,110,110,110,109,109,110,109,108,106,103,101,100,100,100,98,97,96,96,96,96,96,96,96,96,96,95,95,95,95,94,
                108,109,110,110,110,113,114,116,119,122,126,131,134,138,141,145,149,152,156,160,164,169,171,174,177,175,178,179,177,175,174,172,168,163,160,157,151,147,143,138,133,130,128,125,125,124,123,122,121,121,120,120,118,116,115,111,110,110,110,110,113,114,113,112,110,107,105,102,100,100,100,98,97,96,96,96,96,96,96,96,96,96,96,95,95,95,94,
                108,109,110,110,112,115,116,118,122,125,129,133,137,140,144,149,152,157,161,165,169,173,176,179,179,180,180,180,178,178,176,175,171,165,163,160,153,148,143,139,135,132,129,128,127,125,124,124,123,123,122,122,120,118,117,118,115,117,118,118,119,117,116,115,112,109,107,105,100,100,100,100,97,96,96,96,96,96,96,96,96,96,96,95,95,95,95,
                108,109,110,111,114,116,118,122,127,130,133,136,140,144,148,153,157,161,165,169,173,177,180,180,180,180,181,180,180,180,179,178,173,168,165,161,156,149,143,139,136,133,130,129,128,126,126,125,125,125,125,124,122,121,120,120,120,120,121,122,123,122,120,117,114,111,108,106,105,100,100,100,100,96,96,96,96,96,96,96,96,96,96,96,95,95,95,
                107,108,110,113,115,118,121,126,131,134,137,140,143,148,152,157,162,165,169,173,177,181,181,181,180,181,181,181,180,180,180,178,176,170,167,163,158,152,145,140,137,134,132,130,129,127,127,126,127,128,128,126,125,125,125,123,126,128,129,130,130,125,124,119,116,114,112,110,107,106,105,100,100,100,96,96,96,96,96,96,96,96,96,96,96,95,95,
                107,109,111,116,119,122,125,130,135,137,140,144,148,152,156,161,165,168,172,177,181,184,181,181,181,180,180,180,180,180,180,178,178,173,168,163,158,152,146,141,138,136,134,132,130,129,128,128,130,130,130,129,128,129,129,130,132,133,133,134,134,132,128,122,119,116,114,112,108,106,105,105,100,100,100,97,97,97,97,97,97,97,96,96,96,96,95,
                108,110,112,117,122,126,129,135,139,141,144,149,153,156,160,165,168,171,177,181,184,185,182,180,180,179,178,178,180,179,179,178,176,173,168,163,157,152,148,143,139,137,135,133,131,130,130,131,132,132,132,131,132,132,133,134,136,137,137,137,136,134,131,124,121,118,116,114,111,109,107,106,105,100,100,100,97,97,97,97,97,97,97,96,96,96,96,
                108,110,114,120,126,129,134,139,142,144,146,152,158,161,164,168,171,175,181,184,186,186,183,179,178,178,177,175,178,177,177,176,175,173,168,162,156,153,149,145,142,140,138,136,133,132,132,132,134,134,134,134,135,136,137,138,140,140,140,140,139,137,133,127,123,120,118,115,112,108,108,106,106,105,100,100,100,98,98,98,98,98,98,97,96,96,96,
                108,110,116,122,128,133,137,141,143,146,149,154,161,165,168,172,175,180,184,188,189,187,182,178,176,176,175,173,174,173,175,174,173,171,168,161,157,154,150,148,145,143,141,138,135,135,134,135,135,136,136,137,138,139,140,140,140,140,140,140,140,139,135,130,126,123,120,117,114,111,109,108,107,106,105,100,100,100,99,99,98,98,98,98,97,97,96,
                110,112,118,124,130,135,139,142,145,148,151,157,163,169,172,176,179,183,187,190,190,186,180,177,175,173,170,169,169,170,171,172,170,170,167,163,160,157,154,152,149,147,144,140,137,137,136,137,138,138,139,140,141,140,140,140,140,140,140,140,140,138,134,131,128,124,121,118,115,112,110,109,108,107,106,105,100,100,100,99,99,99,98,98,98,97,97,
                110,114,120,126,131,136,140,143,146,149,154,159,166,171,177,180,182,186,190,190,190,185,179,174,171,168,166,163,164,163,166,169,170,170,168,164,162,161,158,155,153,150,147,143,139,139,139,139,140,141,141,142,142,141,140,140,140,140,140,140,140,137,134,131,128,125,122,119,116,114,112,110,109,109,108,107,105,100,100,100,99,99,99,98,98,97,97,
                110,115,121,127,132,136,140,144,148,151,157,162,169,174,178,181,186,188,190,191,190,184,177,172,168,165,162,159,158,158,159,161,166,167,169,166,164,163,161,159,156,153,149,146,142,142,141,142,143,143,143,143,144,142,141,140,140,140,140,140,140,138,134,131,128,125,123,120,117,116,114,112,110,109,108,107,106,105,102,101,100,99,99,99,98,98,97,
                110,116,121,127,132,136,140,144,148,154,160,166,171,176,180,184,189,190,191,191,191,183,176,170,166,163,159,156,154,155,155,158,161,165,170,167,166,165,163,161,158,155,152,150,146,145,145,145,146,146,144,145,145,144,142,141,140,140,140,140,138,136,134,131,128,125,123,121,119,117,115,113,112,111,111,110,108,106,105,102,100,100,99,99,99,98,98,
                110,114,119,126,131,135,140,144,149,158,164,168,172,176,183,184,189,190,191,191,190,183,174,169,165,161,158,154,150,151,152,155,159,164,168,168,168,167,165,163,160,158,155,153,150,148,148,148,148,148,147,146,146,145,143,142,141,140,139,138,136,134,132,131,128,126,124,122,120,118,116,114,113,113,112,111,108,107,106,105,104,102,100,99,99,99,99,
                110,113,119,125,131,136,141,145,150,158,164,168,172,177,183,187,189,191,192,191,190,183,174,168,164,160,157,153,150,149,150,154,158,162,166,170,170,168,166,164,162,160,158,155,152,151,151,151,151,151,149,148,147,146,145,143,142,140,139,137,135,134,132,131,129,127,125,123,121,119,117,116,114,114,113,112,110,108,107,105,103,100,100,100,100,99,99,
                110,112,118,124,130,136,142,146,151,157,163,168,174,178,183,187,189,190,191,192,189,182,174,168,164,160,157,153,149,148,149,153,157,161,167,170,170,170,168,166,165,163,159,156,154,153,155,155,155,155,152,150,149,147,145,143,141,140,139,138,136,134,133,131,130,128,126,124,122,120,119,117,116,115,114,113,111,110,107,106,105,105,102,101,100,100,100,
                110,111,116,122,129,137,142,146,151,158,164,168,172,179,183,186,189,190,192,193,188,182,174,168,164,161,157,154,151,149,151,154,158,161,167,170,170,170,170,169,168,166,160,157,156,156,157,158,159,159,156,153,150,148,146,144,141,140,140,138,136,135,134,133,131,129,127,125,123,122,120,118,117,116,115,114,112,111,110,108,107,106,105,104,102,100,100,
                108,110,115,121,131,137,142,147,152,159,163,167,170,177,182,184,187,189,192,194,189,183,174,169,165,161,158,156,154,153,154,157,160,164,167,171,172,174,174,173,171,168,161,159,158,158,159,161,161,160,158,155,151,149,147,144,142,141,140,138,137,136,135,134,132,130,128,126,125,123,121,119,118,117,116,115,113,112,112,111,110,109,108,107,105,101,100,
                108,110,114,120,128,134,140,146,152,158,162,166,169,175,180,183,186,189,193,195,190,184,176,171,167,163,160,158,157,156,157,159,163,166,170,174,176,178,178,176,172,167,164,161,161,160,161,163,163,163,160,157,153,150,148,146,144,142,141,140,139,138,136,135,134,133,129,127,126,124,122,121,119,118,117,116,114,113,112,111,110,110,109,109,107,104,100,
                107,110,115,119,123,129,135,141,146,156,161,165,168,173,179,182,186,189,193,194,191,184,179,175,170,166,162,161,160,160,161,162,165,169,172,176,178,179,179,176,172,168,165,163,163,163,163,165,166,164,161,158,155,152,150,147,146,144,143,142,141,139,139,138,137,135,131,128,127,125,124,122,121,119,118,116,115,113,112,111,111,110,110,109,109,105,100,
                107,110,114,117,121,126,130,135,142,151,159,163,167,171,177,182,185,189,192,193,191,187,183,179,174,169,167,166,164,164,165,166,169,171,174,178,179,180,180,178,173,169,166,165,165,166,165,168,169,166,163,159,157,154,152,149,148,147,146,145,143,142,141,140,139,138,133,130,128,127,125,124,122,120,118,117,115,112,111,111,111,111,110,109,108,106,100,
                107,109,113,118,122,126,129,134,139,150,156,160,165,170,175,181,184,188,191,192,192,189,185,181,177,173,171,169,168,167,169,170,172,174,176,178,179,180,180,179,175,170,168,166,166,168,168,170,170,168,164,160,158,155,152,151,150,149,149,148,147,145,144,143,142,141,136,133,130,129,127,125,123,120,119,118,115,112,111,111,111,110,109,109,109,105,100,
                105,107,111,117,121,124,127,131,137,148,154,159,164,168,174,181,184,187,190,191,191,190,187,184,180,178,175,174,172,171,173,173,173,176,178,179,180,180,180,179,175,170,168,166,168,169,170,170,170,170,166,161,158,156,154,153,151,150,150,150,150,148,147,146,145,143,139,135,133,131,129,126,124,121,120,118,114,111,111,111,110,110,109,107,106,104,100,
                104,106,110,114,118,121,125,129,135,142,150,157,162,167,173,180,183,186,188,190,190,190,189,184,183,181,180,179,179,176,177,176,176,177,178,179,180,180,179,177,173,169,167,166,167,169,170,170,170,170,167,161,159,157,155,153,151,150,150,150,150,150,150,149,147,145,141,138,135,133,130,127,125,123,121,118,113,111,110,110,109,109,107,106,105,103,100,
                104,106,108,111,115,119,123,128,134,141,148,154,161,166,172,179,182,184,186,189,190,190,190,187,185,183,180,180,180,179,179,177,176,177,178,178,178,177,176,174,171,168,166,164,166,168,170,170,170,170,168,162,159,157,155,153,151,150,150,150,150,150,150,150,150,148,144,140,137,134,132,129,127,125,122,117,111,110,107,107,106,105,104,103,102,101,100,
                103,105,107,110,114,118,122,127,132,140,146,153,159,165,171,176,180,183,185,186,189,190,188,187,184,182,180,180,180,179,178,176,176,176,176,174,174,173,172,170,168,167,165,163,164,165,169,170,170,170,166,162,159,157,155,153,151,150,150,150,150,150,150,150,150,150,146,142,139,136,133,131,128,125,122,117,110,108,106,105,104,103,103,101,101,101,101,
                102,103,106,108,112,116,121,125,130,138,145,151,157,163,170,174,178,181,181,184,186,186,187,186,184,181,180,180,180,179,178,174,173,173,171,170,170,169,168,167,166,164,163,162,161,164,167,169,170,168,164,160,158,157,155,153,151,150,150,150,150,150,150,150,150,150,147,144,141,138,135,133,128,125,122,116,109,107,104,104,103,102,101,101,101,101,101,
                101,102,105,107,110,115,120,124,129,136,143,149,155,161,165,168,170,172,175,176,177,179,181,181,181,180,180,179,177,174,171,167,165,163,161,160,160,160,160,160,157,155,155,154,154,155,157,159,161,161,161,159,156,154,154,153,151,150,150,150,150,150,150,150,150,150,149,147,144,141,137,133,129,123,116,110,107,104,102,102,101,101,101,100,100,100,100,
                102,103,104,106,108,112,116,120,125,129,137,146,154,161,163,165,166,169,172,173,174,175,177,178,178,178,178,177,174,171,168,164,160,158,157,157,156,156,156,155,152,151,150,150,151,151,152,154,156,157,157,156,155,153,152,152,151,150,150,150,150,150,150,150,150,150,150,147,144,141,138,133,127,120,113,109,106,103,101,101,101,100,100,100,100,100,100,
                103,104,105,106,108,110,114,118,123,127,133,143,150,156,160,160,161,162,167,170,171,172,173,175,175,174,174,173,171,168,164,160,156,155,154,153,153,152,152,150,149,148,148,148,148,148,149,149,150,152,152,152,152,151,150,150,150,150,150,150,150,150,150,150,150,150,149,147,144,141,138,132,125,118,111,108,105,103,102,101,101,101,100,100,100,100,100,
                104,105,106,107,108,110,113,117,120,125,129,138,145,151,156,156,157,158,160,164,166,168,170,171,172,171,171,169,166,163,160,156,153,151,150,150,149,149,149,148,146,146,146,146,146,146,146,147,148,148,149,149,149,148,148,148,148,149,149,150,150,150,150,150,150,150,148,146,143,141,136,129,123,117,110,108,105,104,103,102,102,101,101,100,100,100,100,
                103,104,105,106,107,109,111,115,118,122,127,133,140,143,150,152,153,155,157,159,162,164,167,168,168,168,167,166,163,160,157,153,150,148,148,147,147,147,145,145,144,143,143,143,144,144,144,144,145,145,145,145,146,146,146,146,146,147,147,148,149,150,150,150,150,149,147,145,143,141,134,127,123,117,111,108,105,105,104,104,103,103,102,101,100,100,100,
                102,103,104,105,106,107,109,113,116,120,125,129,133,137,143,147,149,151,152,154,158,161,164,165,164,164,163,163,160,157,154,151,149,147,145,145,144,143,141,140,141,141,141,141,141,142,142,142,142,142,142,142,143,143,143,144,144,145,146,146,146,147,148,148,148,148,145,143,142,140,134,128,123,117,112,108,106,105,105,104,104,103,102,101,100,100,99,
                102,103,104,105,105,106,108,110,113,118,123,127,129,132,137,141,142,142,145,150,154,157,161,161,160,160,160,159,157,154,151,148,146,145,143,142,142,139,137,136,137,137,138,138,139,139,139,139,139,139,139,139,140,140,141,142,142,143,144,144,144,145,145,145,145,145,144,142,140,139,136,129,124,119,113,109,106,106,105,104,103,102,101,101,100,99,99,
                102,103,104,104,105,106,107,108,111,116,121,124,126,128,131,134,135,137,139,143,147,152,156,157,157,157,156,155,153,151,148,146,143,142,141,140,138,135,133,132,132,133,133,133,134,135,135,135,135,136,136,137,137,138,138,139,140,141,141,142,142,143,142,142,141,141,140,139,137,134,133,129,125,121,114,110,107,106,106,104,103,102,101,100,99,99,99,
                102,103,104,104,105,105,106,108,110,113,118,121,124,126,128,130,132,134,136,139,143,147,150,154,154,154,153,151,149,148,146,143,141,139,137,136,132,130,128,128,128,129,129,130,130,131,132,132,132,133,134,134,135,135,136,137,138,139,139,140,140,140,139,139,138,137,137,135,132,130,129,127,124,120,116,112,109,106,105,103,102,101,101,100,99,99,99,
                101,102,103,104,104,105,106,107,108,110,114,119,121,124,126,128,129,132,134,137,140,143,147,149,151,151,151,149,147,145,143,141,138,136,134,131,128,126,124,125,125,126,126,127,128,128,129,129,130,130,131,131,132,132,133,134,135,135,136,136,137,137,136,136,135,134,133,131,129,128,127,126,123,119,115,111,109,107,105,104,103,102,101,100,100,100,99,
                101,102,103,103,104,104,105,106,108,110,112,116,119,121,124,125,127,130,132,135,137,140,143,147,149,149,149,147,145,143,141,139,136,133,131,128,125,122,121,122,122,122,123,125,125,126,127,127,127,128,128,128,129,129,130,131,131,132,132,133,133,133,132,132,131,131,130,129,128,126,125,124,121,117,111,109,108,106,105,104,103,102,101,101,100,100,100,
                100,101,102,103,103,104,105,106,107,108,110,114,117,119,121,123,126,128,130,133,136,139,141,144,146,147,146,145,143,141,138,136,133,130,127,124,121,120,120,120,120,120,121,122,123,124,124,125,125,126,126,125,126,126,126,125,126,127,128,128,129,129,128,128,128,128,128,128,126,125,123,122,119,114,109,108,107,106,105,104,103,103,102,102,101,100,100,
                100,101,102,103,104,105,106,107,108,109,110,112,115,117,120,122,125,127,130,132,135,137,139,142,144,144,144,142,140,138,136,132,129,126,123,120,120,119,119,118,119,119,120,120,120,121,122,122,123,123,123,123,122,123,122,122,121,122,122,122,123,123,123,124,125,125,126,126,125,124,122,120,116,113,109,107,106,105,104,104,103,102,102,101,101,100,100,
                100,101,102,103,104,105,106,107,108,109,110,112,114,117,119,122,124,127,129,131,134,136,138,140,142,142,142,140,138,136,133,129,125,122,120,119,118,118,117,116,117,117,118,119,119,120,120,120,121,121,121,122,121,120,120,120,119,119,120,120,120,120,120,120,123,123,124,124,124,123,121,119,114,112,108,106,106,104,104,103,102,102,101,101,100,100,99,
                101,102,103,104,105,106,107,108,109,110,111,111,113,115,118,121,123,125,127,129,131,133,135,137,138,138,137,134,132,130,127,122,120,118,116,116,116,116,115,113,114,115,116,117,117,118,118,119,119,119,120,120,119,118,117,117,116,116,117,117,117,118,119,119,119,120,121,121,121,121,119,116,113,110,107,105,105,103,103,103,102,101,100,100,99,99,99,
                101,102,103,104,105,106,107,108,109,110,111,112,114,116,117,120,122,124,126,129,130,132,133,135,136,136,134,132,129,126,122,120,118,116,114,114,114,114,114,113,113,114,115,116,116,117,117,117,118,118,119,119,118,117,116,116,115,115,116,116,116,117,117,118,118,119,120,120,120,120,119,116,113,109,106,104,104,103,102,102,101,101,100,99,99,99,98,
                101,102,103,104,105,106,107,108,109,110,111,113,115,117,117,118,121,123,126,128,130,130,131,132,133,134,131,129,125,122,120,118,116,114,113,112,112,113,112,112,111,112,113,113,114,115,116,116,117,117,118,118,116,116,115,115,115,114,114,115,116,116,117,117,118,118,119,119,120,120,117,115,112,108,106,104,103,102,102,102,101,100,99,99,99,98,98,
                101,102,103,104,105,105,106,107,108,109,110,111,113,115,117,118,120,122,125,126,127,128,129,130,131,131,128,125,121,120,118,116,114,113,113,111,111,111,111,110,109,110,111,112,113,113,114,115,115,116,117,117,116,115,114,114,113,113,114,114,115,115,116,116,117,118,118,119,119,118,116,114,112,108,105,103,103,102,101,101,100,100,99,99,98,98,97,
                100,101,102,103,104,105,106,107,108,109,110,110,111,113,115,118,120,121,122,124,125,125,126,127,128,127,124,121,120,118,116,114,113,112,112,110,109,109,108,108,108,109,110,111,112,112,113,114,114,115,116,116,115,114,113,112,112,113,113,114,114,115,115,116,116,117,117,118,118,117,115,113,111,107,105,103,102,101,101,100,100,100,99,99,98,98,97,
                100,101,102,103,104,105,105,106,107,108,109,110,110,111,114,116,118,120,120,121,122,122,123,124,123,123,120,118,117,115,114,115,113,111,110,109,108,108,107,107,107,108,109,110,111,111,112,113,113,114,115,115,114,113,112,111,111,112,112,112,113,114,114,115,115,116,116,117,117,116,114,112,109,106,104,102,101,100,100,99,99,99,99,98,98,97,97
            ]
        };
        
        // Iris 数据集
        const irisData = `Id,SepalLengthCm,SepalWidthCm,PetalLengthCm,PetalWidthCm,Species
1,5.1,3.5,1.4,0.2,Iris-setosa
2,4.9,3.0,1.4,0.2,Iris-setosa
3,4.7,3.2,1.3,0.2,Iris-setosa
4,4.6,3.1,1.5,0.2,Iris-setosa
5,5.0,3.6,1.4,0.2,Iris-setosa
6,5.4,3.9,1.7,0.4,Iris-setosa
7,4.6,3.4,1.4,0.3,Iris-setosa
8,5.0,3.4,1.5,0.2,Iris-setosa
9,4.4,2.9,1.4,0.2,Iris-setosa
10,4.9,3.1,1.5,0.1,Iris-setosa
11,5.4,3.7,1.5,0.2,Iris-setosa
12,4.8,3.4,1.6,0.2,Iris-setosa
13,4.8,3.0,1.4,0.1,Iris-setosa
14,4.3,3.0,1.1,0.1,Iris-setosa
15,5.8,4.0,1.2,0.2,Iris-setosa
16,5.7,4.4,1.5,0.4,Iris-setosa
17,5.4,3.9,1.3,0.4,Iris-setosa
18,5.1,3.5,1.4,0.3,Iris-setosa
19,5.7,3.8,1.7,0.3,Iris-setosa
20,5.1,3.8,1.5,0.3,Iris-setosa
21,5.4,3.4,1.7,0.2,Iris-setosa
22,5.1,3.7,1.5,0.4,Iris-setosa
23,4.6,3.6,1.0,0.2,Iris-setosa
24,5.1,3.3,1.7,0.5,Iris-setosa
25,4.8,3.4,1.9,0.2,Iris-setosa
26,5.0,3.0,1.6,0.2,Iris-setosa
27,5.0,3.4,1.6,0.4,Iris-setosa
28,5.2,3.5,1.5,0.2,Iris-setosa
29,5.2,3.4,1.4,0.2,Iris-setosa
30,4.7,3.2,1.6,0.2,Iris-setosa
31,4.8,3.1,1.6,0.2,Iris-setosa
32,5.4,3.4,1.5,0.4,Iris-setosa
33,5.2,4.1,1.5,0.1,Iris-setosa
34,5.5,4.2,1.4,0.2,Iris-setosa
35,4.9,3.1,1.5,0.1,Iris-setosa
36,5.0,3.2,1.2,0.2,Iris-setosa
37,5.5,3.5,1.3,0.2,Iris-setosa
38,4.9,3.1,1.5,0.1,Iris-setosa
39,4.4,3.0,1.3,0.2,Iris-setosa
40,5.1,3.4,1.5,0.2,Iris-setosa
41,5.0,3.5,1.3,0.3,Iris-setosa
42,4.5,2.3,1.3,0.3,Iris-setosa
43,4.4,3.2,1.3,0.2,Iris-setosa
44,5.0,3.5,1.6,0.6,Iris-setosa
45,5.1,3.8,1.9,0.4,Iris-setosa
46,4.8,3.0,1.4,0.3,Iris-setosa
47,5.1,3.8,1.6,0.2,Iris-setosa
48,4.6,3.2,1.4,0.2,Iris-setosa
49,5.3,3.7,1.5,0.2,Iris-setosa
50,5.0,3.3,1.4,0.2,Iris-setosa
51,7.0,3.2,4.7,1.4,Iris-versicolor
52,6.4,3.2,4.5,1.5,Iris-versicolor
53,6.9,3.1,4.9,1.5,Iris-versicolor
54,5.5,2.3,4.0,1.3,Iris-versicolor
55,6.5,2.8,4.6,1.5,Iris-versicolor
56,5.7,2.8,4.5,1.3,Iris-versicolor
57,6.3,3.3,4.7,1.6,Iris-versicolor
58,4.9,2.4,3.3,1.0,Iris-versicolor
59,6.6,2.9,4.6,1.3,Iris-versicolor
60,5.2,2.7,3.9,1.4,Iris-versicolor
61,5.0,2.0,3.5,1.0,Iris-versicolor
62,5.9,3.0,4.2,1.5,Iris-versicolor
63,6.0,2.2,4.0,1.0,Iris-versicolor
64,6.1,2.9,4.7,1.4,Iris-versicolor
65,5.6,2.9,3.6,1.3,Iris-versicolor
66,6.7,3.1,4.4,1.4,Iris-versicolor
67,5.6,3.0,4.5,1.5,Iris-versicolor
68,5.8,2.7,4.1,1.0,Iris-versicolor
69,6.2,2.2,4.5,1.5,Iris-versicolor
70,5.6,2.5,3.9,1.1,Iris-versicolor
71,5.9,3.2,4.8,1.8,Iris-versicolor
72,6.1,2.8,4.0,1.3,Iris-versicolor
73,6.3,2.5,4.9,1.5,Iris-versicolor
74,6.1,2.8,4.7,1.2,Iris-versicolor
75,6.4,2.9,4.3,1.3,Iris-versicolor
76,6.6,3.0,4.4,1.4,Iris-versicolor
77,6.8,2.8,4.8,1.4,Iris-versicolor
78,6.7,3.0,5.0,1.7,Iris-versicolor
79,6.0,2.9,4.5,1.5,Iris-versicolor
80,5.7,2.6,3.5,1.0,Iris-versicolor
81,5.5,2.4,3.8,1.1,Iris-versicolor
82,5.5,2.4,3.7,1.0,Iris-versicolor
83,5.8,2.7,3.9,1.2,Iris-versicolor
84,6.0,2.7,5.1,1.6,Iris-versicolor
85,5.4,3.0,4.5,1.5,Iris-versicolor
86,6.0,3.4,4.5,1.6,Iris-versicolor
87,6.7,3.1,4.7,1.5,Iris-versicolor
88,6.3,2.3,4.4,1.3,Iris-versicolor
89,5.6,3.0,4.1,1.3,Iris-versicolor
90,5.5,2.5,4.0,1.3,Iris-versicolor
91,5.5,2.6,4.4,1.2,Iris-versicolor
92,6.1,3.0,4.6,1.4,Iris-versicolor
93,5.8,2.6,4.0,1.2,Iris-versicolor
94,5.0,2.3,3.3,1.0,Iris-versicolor
95,5.6,2.7,4.2,1.3,Iris-versicolor
96,5.7,3.0,4.2,1.2,Iris-versicolor
97,5.7,2.9,4.2,1.3,Iris-versicolor
98,6.2,2.9,4.3,1.3,Iris-versicolor
99,5.1,2.5,3.0,1.1,Iris-versicolor
100,5.7,2.8,4.1,1.3,Iris-versicolor
101,6.3,3.3,6.0,2.5,Iris-virginica
102,5.8,2.7,5.1,1.9,Iris-virginica
103,7.1,3.0,5.9,2.1,Iris-virginica
104,6.3,2.9,5.6,1.8,Iris-virginica
105,6.5,3.0,5.8,2.2,Iris-virginica
106,7.6,3.0,6.6,2.1,Iris-virginica
107,4.9,2.5,4.5,1.7,Iris-virginica
108,7.3,2.9,6.3,1.8,Iris-virginica
109,6.7,2.5,5.8,1.8,Iris-virginica
110,7.2,3.6,6.1,2.5,Iris-virginica
111,6.5,3.2,5.1,2.0,Iris-virginica
112,6.4,2.7,5.3,1.9,Iris-virginica
113,6.8,3.0,5.5,2.1,Iris-virginica
114,5.7,2.5,5.0,2.0,Iris-virginica
115,5.8,2.8,5.1,2.4,Iris-virginica
116,6.4,3.2,5.3,2.3,Iris-virginica
117,6.5,3.0,5.5,1.8,Iris-virginica
118,7.7,3.8,6.7,2.2,Iris-virginica
119,7.7,2.6,6.9,2.3,Iris-virginica
120,6.0,2.2,5.0,1.5,Iris-virginica
121,6.9,3.2,5.7,2.3,Iris-virginica
122,5.6,2.8,4.9,2.0,Iris-virginica
123,7.7,2.8,6.7,2.0,Iris-virginica
124,6.3,2.7,4.9,1.8,Iris-virginica
125,6.7,3.3,5.7,2.1,Iris-virginica
126,7.2,3.2,6.0,1.8,Iris-virginica
127,6.2,2.8,4.8,1.8,Iris-virginica
128,6.1,3.0,4.9,1.8,Iris-virginica
129,6.4,2.8,5.6,2.1,Iris-virginica
130,7.2,3.0,5.8,1.6,Iris-virginica
131,7.4,2.8,6.1,1.9,Iris-virginica
132,7.9,3.8,6.4,2.0,Iris-virginica
133,6.4,2.8,5.6,2.2,Iris-virginica
134,6.3,2.8,5.1,1.5,Iris-virginica
135,6.1,2.6,5.6,1.4,Iris-virginica
136,7.7,3.0,6.1,2.3,Iris-virginica
137,6.3,3.4,5.6,2.4,Iris-virginica
138,6.4,3.1,5.5,1.8,Iris-virginica
139,6.0,3.0,4.8,1.8,Iris-virginica
140,6.9,3.1,5.4,2.1,Iris-virginica
141,6.7,3.1,5.6,2.4,Iris-virginica
142,6.9,3.1,5.1,2.3,Iris-virginica
143,5.8,2.7,5.1,1.9,Iris-virginica
144,6.8,3.2,5.9,2.3,Iris-virginica
145,6.7,3.3,5.7,2.5,Iris-virginica
146,6.7,3.0,5.2,2.3,Iris-virginica
147,6.3,2.5,5.0,1.9,Iris-virginica
148,6.5,3.0,5.2,2.0,Iris-virginica
149,6.2,3.4,5.4,2.3,Iris-virginica
150,5.9,3.0,5.1,1.8,Iris-virginica`;
        
        // 多维数据
        const multiDimData = [
            { country: "中国", gdp: 14.72, population: 1402, area: 9.60 },
            { country: "美国", gdp: 21.43, population: 331, area: 9.83 },
            { country: "日本", gdp: 5.08, population: 126, area: 0.38 },
            { country: "德国", gdp: 3.85, population: 83, area: 0.36 },
            { country: "印度", gdp: 2.94, population: 1380, area: 3.29 },
            { country: "英国", gdp: 2.83, population: 67, area: 0.24 },
            { country: "法国", gdp: 2.71, population: 65, area: 0.64 },
            { country: "巴西", gdp: 1.84, population: 213, area: 8.51 },
            { country: "意大利", gdp: 1.99, population: 60, area: 0.30 },
            { country: "加拿大", gdp: 1.64, population: 38, area: 9.98 },
            { country: "俄罗斯", gdp: 1.70, population: 144, area: 17.10 },
            { country: "韩国", gdp: 1.63, population: 51, area: 0.10 },
            { country: "澳大利亚", gdp: 1.38, population: 25, area: 7.69 },
            { country: "西班牙", gdp: 1.39, population: 47, area: 0.51 },
            { country: "墨西哥", gdp: 1.27, population: 126, area: 1.96 }
        ];
        
        // 房价数据（模拟）
        const housePriceData = [];
        for (let year = 2010; year <= 2020; year++) {
            const yearData = [];
            const basePrice = 100 + (year - 2010) * 20;
            
            for (let i = 0; i < 500; i++) {
                // 生成正态分布的房价数据
                const price = basePrice + Math.random() * 100 + d3.randomNormal(0, 20)();
                yearData.push(price);
            }
            
            housePriceData.push({
                year: year,
                prices: yearData
            });
        }
        
        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            // 绘制火山等高线图
            drawVolcanoContour();
            
            // 绘制Iris数据密度图
            drawIrisDensity();
            
            // 填充Iris数据表格
            fillIrisTable();
            
            // 绘制多维数据密度图
            drawMultiDensity();
            
            // 设置图像选择事件
            document.getElementById('image-select').addEventListener('change', updateImage);
            document.getElementById('generate-contour').addEventListener('click', generateImageContour);
            
            // 设置多维数据更新事件
            document.getElementById('update-density').addEventListener('click', drawMultiDensity);
            
            // 设置动态直方图控制
            document.getElementById('play-btn').addEventListener('click', playHistogramAnimation);
            document.getElementById('pause-btn').addEventListener('click', pauseHistogramAnimation);
            document.getElementById('reset-btn').addEventListener('click', resetHistogramAnimation);
            
            // 初始化图像
            updateImage();
        });
        
        // 绘制火山等高线图
        function drawVolcanoContour() {
            const data = [{
                z: [],
                type: 'contour',
                colorscale: 'Hot',
                contours: {
                    coloring: 'heatmap'
                }
            }];
            
            // 将一维数据转换为二维数组
            const z = [];
            let row = [];
            for (let i = 0; i < volcanoData.values.length; i++) {
                row.push(volcanoData.values[i]);
                if (row.length === volcanoData.width) {
                    z.push(row);
                    row = [];
                }
            }
            
            data[0].z = z;
            
            const layout = {
                title: '火山高程等高线图',
                autosize: true,
                margin: { t: 40, b: 20, l: 20, r: 20 },
                height: 480
            };
            
            Plotly.newPlot('volcano-chart', data, layout);
        }
        
        // 更新图像
        function updateImage() {
            const imageSelect = document.getElementById('image-select');
            const selectedImage = imageSelect.value;
            
            let imageUrl;
            switch(selectedImage) {
                case 'mountain':
                    imageUrl = 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=500';
                    break;
                case 'valley':
                    imageUrl = 'https://images.unsplash.com/photo-1476820865390-c52aeebb9891?w=500';
                    break;
                case 'lake':
                    imageUrl = 'https://images.unsplash.com/photo-1501785888041-af3ef285b470?w=500';
                    break;
                default:
                    imageUrl = 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=500';
            }
            
            document.getElementById('original-image').src = imageUrl;
        }
        
        // 生成图像等高线
        function generateImageContour() {
            const img = document.getElementById('original-image');
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            img.onload = function() {
                canvas.width = img.width;
                canvas.height = img.height;
                ctx.drawImage(img, 0, 0, img.width, img.height);
                
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                // 创建灰度值数组
                const z = [];
                for (let y = 0; y < canvas.height; y += 5) {
                    const row = [];
                    for (let x = 0; x < canvas.width; x += 5) {
                        const idx = (y * canvas.width + x) * 4;
                        const r = data[idx];
                        const g = data[idx + 1];
                        const b = data[idx + 2];
                        // 计算灰度值
                        const gray = 0.299 * r + 0.587 * g + 0.114 * b;
                        row.push(gray);
                    }
                    z.push(row);
                }
                
                // 绘制等高线图
                const contourData = [{
                    z: z,
                    type: 'contour',
                    colorscale: 'Gray',
                    contours: {
                        coloring: 'lines'
                    }
                }];
                
                const layout = {
                    title: '图像灰度等高线图',
                    autosize: true,
                    margin: { t: 40, b: 20, l: 20, r: 20 },
                    height: 480,
                    xaxis: { visible: false },
                    yaxis: { visible: false }
                };
                
                Plotly.newPlot('image-contour', contourData, layout);
            };
        }
        
        // 绘制Iris数据密度图
        function drawIrisDensity() {
            // 解析CSV数据
            const rows = irisData.split('\n').slice(1);
            const data = {
                setosa: { x: [], y: [] },
                versicolor: { x: [], y: [] },
                virginica: { x: [], y: [] }
            };
            
            rows.forEach(row => {
                const cols = row.split(',');
                const species = cols[5];
                const sepalLength = parseFloat(cols[1]);
                const sepalWidth = parseFloat(cols[2]);
                
                if (species === 'Iris-setosa') {
                    data.setosa.x.push(sepalLength);
                    data.setosa.y.push(sepalWidth);
                } else if (species === 'Iris-versicolor') {
                    data.versicolor.x.push(sepalLength);
                    data.versicolor.y.push(sepalWidth);
                } else if (species === 'Iris-virginica') {
                    data.virginica.x.push(sepalLength);
                    data.virginica.y.push(sepalWidth);
                }
            });
            
            // 创建图表数据
            const plotData = [
                {
                    x: data.setosa.x,
                    y: data.setosa.y,
                    mode: 'markers',
                    type: 'scatter',
                    name: 'Iris-setosa',
                    marker: { color: 'rgba(255, 100, 100, 0.7)', size: 8 }
                },
                {
                    x: data.versicolor.x,
                    y: data.versicolor.y,
                    mode: 'markers',
                    type: 'scatter',
                    name: 'Iris-versicolor',
                    marker: { color: 'rgba(100, 255, 100, 0.7)', size: 8 }
                },
                {
                    x: data.virginica.x,
                    y: data.virginica.y,
                    mode: 'markers',
                    type: 'scatter',
                    name: 'Iris-virginica',
                    marker: { color: 'rgba(100, 100, 255, 0.7)', size: 8 }
                },
                {
                    x: data.setosa.x,
                    y: data.setosa.y,
                    name: 'setosa密度',
                    ncontours: 20,
                    colorscale: 'Reds',
                    showscale: false,
                    type: 'histogram2dcontour'
                },
                {
                    x: data.versicolor.x,
                    y: data.versicolor.y,
                    name: 'versicolor密度',
                    ncontours: 20,
                    colorscale: 'Greens',
                    showscale: false,
                    type: 'histogram2dcontour'
                },
                {
                    x: data.virginica.x,
                    y: data.virginica.y,
                    name: 'virginica密度',
                    ncontours: 20,
                    colorscale: 'Blues',
                    showscale: false,
                    type: 'histogram2dcontour'
                }
            ];
            
            const layout = {
                title: '鸢尾花数据集密度分布',
                xaxis: { title: '花萼长度 (cm)' },
                yaxis: { title: '花萼宽度 (cm)' },
                height: 480,
                legend: { orientation: 'h' }
            };
            
            Plotly.newPlot('iris-chart', plotData, layout);
        }
        
        // 填充Iris数据表格
        function fillIrisTable() {
            const tableBody = document.getElementById('iris-data');
            const rows = irisData.split('\n').slice(1, 11); // 只显示前10行
            
            rows.forEach(row => {
                const cols = row.split(',');
                const tr = document.createElement('tr');
                
                cols.forEach((col, index) => {
                    const td = document.createElement('td');
                    td.textContent = col;
                    
                    // 为品种列添加特殊样式
                    if (index === 5) {
                        if (col === 'Iris-setosa') {
                            td.style.color = '#ff6464';
                        } else if (col === 'Iris-versicolor') {
                            td.style.color = '#64ff64';
                        } else {
                            td.style.color = '#6464ff';
                        }
                    }
                    
                    tr.appendChild(td);
                });
                
                tableBody.appendChild(tr);
            });
        }
        
        // 绘制多维数据密度图
        function drawMultiDensity() {
            const xDim = document.getElementById('x-dimension').value;
            const yDim = document.getElementById('y-dimension').value;
            
            let xLabel, yLabel;
            const x = [];
            const y = [];
            
            multiDimData.forEach(country => {
                if (xDim === 'gdp') {
                    x.push(country.gdp);
                    xLabel = 'GDP (万亿美元)';
                } else if (xDim === 'population') {
                    x.push(country.population);
                    xLabel = '人口 (百万人)';
                } else {
                    x.push(country.area);
                    xLabel = '面积 (万平方公里)';
                }
                
                if (yDim === 'gdp') {
                    y.push(country.gdp);
                    yLabel = 'GDP (万亿美元)';
                } else if (yDim === 'population') {
                    y.push(country.population);
                    yLabel = '人口 (百万人)';
                } else {
                    y.push(country.area);
                    yLabel = '面积 (万平方公里)';
                }
            });
            
            const plotData = [
                {
                    x: x,
                    y: y,
                    mode: 'markers+text',
                    type: 'scatter',
                    text: multiDimData.map(d => d.country),
                    textposition: 'top center',
                    marker: { 
                        size: 12,
                        color: 'rgba(255, 150, 50, 0.8)'
                    }
                },
                {
                    x: x,
                    y: y,
                    name: '密度',
                    ncontours: 20,
                    colorscale: 'Viridis',
                    showscale: true,
                    type: 'histogram2dcontour'
                }
            ];
            
            const layout = {
                title: `国家数据密度分布 (${xDim} vs ${yDim})`,
                xaxis: { title: xLabel },
                yaxis: { title: yLabel },
                height: 480
            };
            
            Plotly.newPlot('multi-chart', plotData, layout);
        }
        
        // 动态直方图相关变量
        let histogramAnimation;
        let currentYearIndex = 0;
        
        // 绘制直方图
        function drawHistogram(yearIndex) {
            const yearData = housePriceData[yearIndex];
            
            const trace = {
                x: yearData.prices,
                type: 'histogram',
                histnorm: 'probability density',
                name: yearData.year,
                opacity: 0.7,
                marker: {
                    color: `rgb(${50 + yearIndex * 20}, ${150 - yearIndex * 15}, ${200 - yearIndex * 10})`
                },
                autobinx: false,
                xbins: {
                    start: 50,
                    end: 500,
                    size: 20
                }
            };
            
            const layout = {
                title: `房价分布 (${yearData.year}年)`,
                xaxis: { title: '房价 (万元/平方米)' },
                yaxis: { title: '密度' },
                height: 480,
                bargap: 0.05
            };
            
            Plotly.newPlot('histogram-chart', [trace], layout);
        }
        
        // 播放直方图动画
        function playHistogramAnimation() {
            if (histogramAnimation) return;
            
            histogramAnimation = setInterval(() => {
                currentYearIndex = (currentYearIndex + 1) % housePriceData.length;
                drawHistogram(currentYearIndex);
            }, 1500);
        }
        
        // 暂停动画
        function pauseHistogramAnimation() {
            if (histogramAnimation) {
                clearInterval(histogramAnimation);
                histogramAnimation = null;
            }
        }
        
        // 重置动画
        function resetHistogramAnimation() {
            pauseHistogramAnimation();
            currentYearIndex = 0;
            drawHistogram(currentYearIndex);
        }
        
        // 初始绘制直方图
        drawHistogram(0);
    </script>
</body>
</html>
