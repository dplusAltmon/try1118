<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数绘文产·2024</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f1e6 0%, #e8e2d2 100%);
            color: #4a4a4a;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            padding: 20px 0 30px;
            position: relative;
        }
        
        .title {
            font-size: 3.8rem;
            font-weight: 300;
            color: #6b5b95;
            letter-spacing: 4px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
            position: relative;
            display: inline-block;
        }
        
        .title::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 180px;
            height: 4px;
            background: linear-gradient(90deg, #b8a9c9, #c8b8db);
            border-radius: 2px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #7d7d7d;
            font-weight: 300;
            margin-top: 5px;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(4, 400px);
            gap: 25px;
            margin-bottom: 35px;
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.85);
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.06);
            padding: 11px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .chart-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1);
        }
        
        .chart-title {
            font-size: 1.2rem;
            font-weight: 500;
            color: #5a5a5a;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            display: flex;
            align-items: center;
        }
        
        .chart-title svg {
            margin-right: 10px;
            width: 24px;
            height: 24px;
            fill: #8a7ea6;
        }
        
        .chart-content {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        
        .signature {
            text-align: center;
            padding: 20px;
            font-size: 1.1rem;
            color: #6b5b95;
            font-weight: 500;
            letter-spacing: 1px;
            border-top: 1px solid rgba(0, 0, 0, 0.08);
            margin-top: 20px;
        }
        
        .data-source {
            text-align: center;
            font-size: 0.9rem;
            color: #888;
            margin-top: 5px;
            font-style: italic;
        }
        
        .chart-container:nth-child(1) { grid-area: 1 / 1 / 2 / 2; }
        .chart-container:nth-child(2) { grid-area: 1 / 2 / 2 / 3; }
        .chart-container:nth-child(3) { grid-area: 3 / 1 / 4 / 2; }
        .chart-container:nth-child(4) { grid-area: 2 / 1 / 3 / 2; }
        .chart-container:nth-child(5) { grid-area: 2 / 2 / 3 / 3; }
        .chart-container:nth-child(6) { grid-area: 3 / 2 / 4 / 3; }
        .chart-container:nth-child(7) { grid-area: 4 / 1 / 5 / 3; }
        
        .tooltip {
            position: absolute;
            padding: 12px;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid #ddd;
            border-radius: 8px;
            pointer-events: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            font-size: 0.9rem;
            z-index: 100;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 15px;
            font-size: 0.8rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 0 10px 5px;
        }
        
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        /* 雷达图专用样式 */
        .radar-grid {
            stroke: #ddd;
            stroke-width: 0.5;
            fill: none;
        }
        
        .radar-axis {
            stroke: #999;
            stroke-width: 1;
        }
        
        .radar-area {
            fill: rgba(107, 91, 149, 0.3);
            stroke: #6b5b95;
            stroke-width: 2;
            fill-opacity: 0.5;
        }
        
        .radar-point {
            fill: #6b5b95;
            stroke: #fff;
            stroke-width: 1;
            r: 4;
        }
        
        .radar-label {
            font-size: 12px;
            fill: #5a5a5a;
            text-anchor: middle;
        }
        
        /* Three.js 容器样式 */
        .three-container {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">数绘文产·2024</h1>
            <p class="subtitle">文化产业数据多维可视化分析报告</p>
        </div>
        
        <div class="dashboard">
            <!-- 图表1：文化产业营业收入构成 -->
            <div class="chart-container">
                <div class="chart-title">
                    <svg viewBox="0 0 24 24"><path d="M3,5H21V7H3V5M3,11H21V13H3V11M3,17H21V19H3V17Z"/></svg>
                    文化产业营业收入构成(亿元)
                </div>
                <div class="chart-content" id="chart1"></div>
            </div>
            
            <!-- 图表2：区域文化产业分布（Three.js 3D柱状图） -->
            <div class="chart-container">
                <div class="chart-title">
                    <svg viewBox="0 0 24 24"><path d="M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5M12,2A7,7 0 0,0 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9A7,7 0 0,0 12,2Z"/></svg>
                    区域文化产业分布（3D）
                </div>
                <div class="chart-content">
                    <div id="chart2" class="three-container"></div>
                </div>
            </div>
            
            <!-- 图表3：文化新业态占比 -->
            <div class="chart-container">
                <div class="chart-title">
                    <svg viewBox="0 0 24 24"><path d="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z"/></svg>
                    文化新业态占比
                </div>
                <div class="chart-content" id="chart3"></div>
            </div>
            
            <!-- 图表4：零售业态增长情况（热力图） -->
            <div class="chart-container">
                <div class="chart-title">
                    <svg viewBox="0 0 24 24"><path d="M16,6L19,10H21C22.11,10 23,10.89 23,12V15H21V12H19V15H17V12H15V15H13V12H11V15H9V12H7V15H5V12C5,10.89 5.89,10 7,10H13L16,6M12,2C13.1,2 14,2.9 14,4C14,5.1 13.1,6 12,6C10.9,6 10,5.1 10,4C10,2.9 10.9,2 12,2M12,8C13.1,8 14,8.9 14,10C14,11.1 13.1,12 12,12C10.9,12 10,11.1 10,10C10,8.9 10.9,8 12,8M6,22C4.89,22 4,21.1 4,20C4,18.89 4.89,18 6,18C7.1,18 8,18.9 8,20C8,21.1 7.1,22 6,22M18,22C16.9,22 16,21.1 16,20C16,18.89 16.9,18 18,18C19.1,18 20,18.9 20,20C20,21.1 19.1,22 18,22Z"/></svg>
                    零售业态增长情况（热力图）
                </div>
                <div class="chart-content" id="chart4"></div>
            </div>
            
            <!-- 图表5：GDP与文化产业增速对比（雷达图） -->
            <div class="chart-container">
                <div class="chart-title">
                    <svg viewBox="0 0 24 24"><path d="M9,17H15V15H9V17M9,13H15V11H9V13M21,3H3C1.89,3 1,3.89 1,5V19A2,2 0 0,0 3,21H21A2,2 0 0,0 23,19V5C23,3.89 22.1,3 21,3M21,19H3V5H21V19M19,7H5V9H19V7Z"/></svg>
                    GDP与文化产业增速对比（雷达图）
                </div>
                <div class="chart-content" id="chart5"></div>
            </div>
            
            <!-- 图表6：行业资产与营收关系（Three.js 3D气泡图） -->
            <div class="chart-container">
                <div class="chart-title">
                    <svg viewBox="0 0 24 24"><path d="M16,11.78L20.24,4.45L21.97,5.45L16.74,14.5L10.23,10.13L5.46,19.22L3.72,18.24L10.53,8.13L16,11.78M12,8A1,1 0 0,0 11,7A1,1 0 0,0 10,8A1,1 0 0,0 11,9A1,1 0 0,0 12,8Z"/></svg>
                    行业资产与营收关系（3D气泡）
                </div>
                <div class="chart-content">
                    <div id="chart6" class="three-container"></div>
                </div>
            </div>
            
            <!-- 图表7：GDP季度增速趋势 -->
            <div class="chart-container">
                <div class="chart-title">
                    <svg viewBox="0 0 24 24"><path d="M16,17.5V12H17V17.5H16M12.5,17.5V12H13.5V17.5H12.5M9,17.5V12H10V17.5H9M4.5,20A1.5,1.5 0 0,1 3,18.5V5.5A1.5,1.5 0 0,1 4.5,4H19.5A1.5,1.5 0 0,1 21,5.5V18.5A1.5,1.5 0 0,1 19.5,20H4.5Z"/></svg>
                    GDP季度增速趋势(2020-2025)
                </div>
                <div class="chart-content" id="chart7"></div>
            </div>
        </div>
        
        <div class="signature">
            22计传张颖惠202201083018｜22计传刘竹202201083025
        </div>
        
        <div class="data-source">
            数据来源：国家统计局《2024年全国文化及相关产业发展情况报告》、《2025年二季度和上半年国内生产总值初步核算结果》、中国产业经济信息网《2025年6月份社会消费品零售总额》
        </div>
    </div>

    <script>
        // 莫兰迪配色方案
        const colors = {
            primary: ["#9a8c98", "#4a4e69", "#c9ada7", "#f2e9e4", "#22223b"],
            secondary: ["#6d6875", "#b5838d", "#e5989b", "#ffb4a2", "#ffcdb2"],
            accent: ["#6b5b95", "#88a2aa", "#c8b8db", "#b8a9c9", "#7d7d7d"]
        };
        
        // 创建工具提示
        const tooltip = d3.select("body")
            .append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);
        
        // 图表1：文化产业营业收入构成
        const drawChart1 = () => {
            const data = [
                {category: "文化服务业", value: 109134, percent: 57.0},
                {category: "文化制造业", value: 49609, percent: 25.9},
                {category: "批发零售业", value: 32679, percent: 17.1}
            ];
            
            const container = d3.select("#chart1");
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height - 40;
            const margin = {top: 20, right: 20, bottom: 40, left: 60};
            
            const svg = container.append("svg")
                .attr("width", width)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            // X轴比例尺
            const x = d3.scaleBand()
                .domain(data.map(d => d.category))
                .range([0, width - margin.left - margin.right])
                .padding(0.2);
            
            // Y轴比例尺
            const y = d3.scaleLinear()
                .domain([0, d3.max(data, d => d.value) * 1.1])
                .range([height, 0]);
            
            // 添加条形
            svg.selectAll(".bar")
                .data(data)
                .enter()
                .append("rect")
                .attr("class", "bar")
                .attr("x", d => x(d.category))
                .attr("y", d => y(d.value))
                .attr("width", x.bandwidth())
                .attr("height", d => height - y(d.value))
                .attr("fill", (d, i) => colors.primary[i])
                .attr("rx", 4)
                .attr("ry", 4)
                .on("mouseover", function(event, d) {
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", .9);
                    tooltip.html(`${d.category}<br>${d.value.toLocaleString()}亿元<br>占比: ${d.percent}%`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition()
                        .duration(500)
                        .style("opacity", 0);
                });
            
            // 添加数值标签
            svg.selectAll(".label")
                .data(data)
                .enter()
                .append("text")
                .attr("class", "label")
                .attr("x", d => x(d.category) + x.bandwidth() / 2)
                .attr("y", d => y(d.value) - 10)
                .attr("text-anchor", "middle")
                .attr("fill", "#4a4a4a")
                .text(d => d.value.toLocaleString());
            
            // 添加X轴
            svg.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x))
                .selectAll("text")
                .attr("dy", "0.35em")
                .attr("dx", "-0.5em")
                .attr("transform", "rotate(-15)")
                .style("text-anchor", "end");
            
            // 添加Y轴
            svg.append("g")
                .call(d3.axisLeft(y).ticks(5).tickFormat(d => d + "亿"))
                .append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", 6)
                .attr("dy", "0.71em")
                .attr("fill", "#5a5a5a")
                .text("营业收入(亿元)");
        };
        
        // 图表2：区域文化产业分布（Three.js 3D柱状图）
        const drawChart2 = () => {
            const data = [
                {region: "东部地区", value: 141750, color: colors.primary[0]},
                {region: "中部地区", value: 28726, color: colors.primary[1]},
                {region: "西部地区", value: 18462, color: colors.primary[2]},
                {region: "东北地区", value: 2485, color: colors.primary[3]}
            ];
            
            const container = document.getElementById('chart2');
            const width = container.clientWidth;
            const height = container.clientHeight;
            
            // 创建场景
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0xf5f5f5);
            
            // 创建相机
            const camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
            camera.position.set(0, 30, 50);
            camera.lookAt(0, 0, 0);
            
            // 创建渲染器
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(width, height);
            container.appendChild(renderer.domElement);
            
            // 添加轨道控制器
            const controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            
            // 添加光源
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(10, 20, 10);
            scene.add(directionalLight);
            
            // 创建柱状图
            const barWidth = 5;
            const barDepth = 5;
            const gap = 3;
            
            data.forEach((d, i) => {
                const barHeight = d.value / 5000; // 缩放比例
                const geometry = new THREE.BoxGeometry(barWidth, barHeight, barDepth);
                const material = new THREE.MeshPhongMaterial({ 
                    color: new THREE.Color(d.color),
                    specular: 0x111111,
                    shininess: 30
                });
                const cube = new THREE.Mesh(geometry, material);
                cube.position.x = i * (barWidth + gap) - (data.length * (barWidth + gap)) / 2 + (barWidth + gap) / 2;
                cube.position.y = barHeight / 2;
                scene.add(cube);
                
                // 添加标签
                const labelCanvas = document.createElement('canvas');
                labelCanvas.width = 128;
                labelCanvas.height = 64;
                const context = labelCanvas.getContext('2d');
                context.fillStyle = '#ffffff';
                context.fillRect(0, 0, labelCanvas.width, labelCanvas.height);
                context.fillStyle = '#333333';
                context.font = '14px Arial';
                context.textAlign = 'center';
                context.fillText(d.region, labelCanvas.width/2, 20);
                context.fillText(d.value.toLocaleString() + '亿元', labelCanvas.width/2, 40);
                
                const texture = new THREE.CanvasTexture(labelCanvas);
                const labelMaterial = new THREE.SpriteMaterial({ map: texture });
                const label = new THREE.Sprite(labelMaterial);
                label.position.set(cube.position.x, barHeight + 2, 0);
                label.scale.set(10, 5, 1);
                scene.add(label);
            });
            
            // 添加坐标轴辅助
            const axesHelper = new THREE.AxesHelper(20);
            scene.add(axesHelper);
            
            // 添加网格地面
            const gridHelper = new THREE.GridHelper(30, 30, 0x888888, 0xcccccc);
            scene.add(gridHelper);
            
            // 动画循环
            function animate() {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(scene, camera);
            }
            animate();
            
            // 响应式调整
            window.addEventListener('resize', () => {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
        };
        
        // 图表3：文化新业态占比
        const drawChart3 = () => {
            const data = [
                {type: "文化新业态", value: 66600, percent: 34.8},
                {type: "传统业态", value: 124823, percent: 65.2}
            ];
            
            const container = d3.select("#chart3");
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height - 40;
            const radius = Math.min(width, height) / 2 - 20;
            
            const svg = container.append("svg")
                .attr("width", width)
                .attr("height", height)
                .append("g")
                .attr("transform", `translate(${width/2},${height/2})`);
            
            const pie = d3.pie()
                .value(d => d.value)
                .sort(null);
            
            const arc = d3.arc()
                .innerRadius(radius * 0.5)
                .outerRadius(radius);
            
            const arcs = svg.selectAll("arc")
                .data(pie(data))
                .enter()
                .append("g")
                .attr("class", "arc");
            
            arcs.append("path")
                .attr("d", arc)
                .attr("fill", d => d.data.type === "文化新业态" ? colors.accent[0] : colors.primary[3])
                .attr("stroke", "#fff")
                .attr("stroke-width", 2)
                .on("mouseover", function(event, d) {
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", .9);
                    tooltip.html(`${d.data.type}<br>${d.data.value.toLocaleString()}亿元<br>占比: ${d.data.percent}%`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition()
                        .duration(500)
                        .style("opacity", 0);
                });
            
            // 添加中心文本
            svg.append("text")
                .attr("text-anchor", "middle")
                .attr("dy", "-0.5em")
                .attr("font-size", "16px")
                .attr("fill", colors.accent[0])
                .text("34.8%");
            
            svg.append("text")
                .attr("text-anchor", "middle")
                .attr("dy", "1.2em")
                .attr("font-size", "14px")
                .attr("fill", "#5a5a5a")
                .text("新业态占比");
            
            // 添加图例
            const legend = container.append("div")
                .attr("class", "legend");
            
            const legendItems = legend.selectAll(".legend-item")
                .data(data)
                .enter()
                .append("div")
                .attr("class", "legend-item");
            
            legendItems.append("div")
                .attr("class", "legend-color")
                .style("background-color", d => d.type === "文化新业态" ? colors.accent[0] : colors.primary[3]);
            
            legendItems.append("text")
                .text(d => `${d.type}: ${d.value.toLocaleString()}亿元`);
        };
        
        // 图表4：零售业态增长情况（热力图）
        const drawChart4 = () => {
            const data = [
                {category: "便利店", growth: 7.5, color: colors.primary[0]},
                {category: "超市", growth: 5.4, color: colors.primary[1]},
                {category: "百货店", growth: 1.2, color: colors.primary[3]},
                {category: "专业店", growth: 6.4, color: colors.primary[0]},
                {category: "品牌专卖店", growth: 2.4, color: colors.primary[2]}
            ];
            
            const container = d3.select("#chart4");
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height - 40;
            const margin = {top: 30, right: 20, bottom: 40, left: 20};
            
            const svg = container.append("svg")
                .attr("width", width)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            // 创建热力方块
            const cellSize = Math.min((width - margin.left - margin.right) / data.length, 70);
            const cellPadding = 10;
            
            svg.selectAll("rect")
                .data(data)
                .enter()
                .append("rect")
                .attr("x", (d, i) => i * (cellSize + cellPadding))
                .attr("y", height/2 - cellSize/2)
                .attr("width", cellSize)
                .attr("height", cellSize)
                .attr("fill", d => {
                    // 根据增长率设置颜色深浅
                    const intensity = d.growth / 10;
                    return d3.rgb(d.color).brighter(1 - intensity);
                })
                .attr("stroke", "#fff")
                .attr("stroke-width", 2)
                .attr("rx", 6)
                .attr("ry", 6)
                .on("mouseover", function(event, d) {
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", .9);
                    tooltip.html(`${d.category}<br>同比增长: ${d.growth}%`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition()
                        .duration(500)
                        .style("opacity", 0);
                });
            
            // 添加增长率标签
            svg.selectAll("text.value")
                .data(data)
                .enter()
                .append("text")
                .attr("x", (d, i) => i * (cellSize + cellPadding) + cellSize/2)
                .attr("y", height/2 + 5)
                .attr("text-anchor", "middle")
                .attr("font-size", "16px")
                .attr("fill", "#fff")
                .attr("font-weight", "bold")
                .text(d => d.growth + "%");
            
            // 添加类别标签
            svg.selectAll("text.label")
                .data(data)
                .enter()
                .append("text")
                .attr("x", (d, i) => i * (cellSize + cellPadding) + cellSize/2)
                .attr("y", height/2 - cellSize/2 - 10)
                .attr("text-anchor", "middle")
                .attr("font-size", "12px")
                .attr("fill", "#5a5a5a")
                .text(d => d.category);
            
            // 添加图例
            const legend = svg.append("g")
                .attr("transform", `translate(0,${height - 20})`);
            
            const gradient = legend.append("defs")
                .append("linearGradient")
                .attr("id", "heatmap-gradient")
                .attr("x1", "0%")
                .attr("y1", "0%")
                .attr("x2", "100%")
                .attr("y2", "0%");
            
            gradient.append("stop")
                .attr("offset", "0%")
                .attr("stop-color", d3.rgb(colors.primary[3]).brighter(0.8));
                
            gradient.append("stop")
                .attr("offset", "100%")
                .attr("stop-color", d3.rgb(colors.primary[0]).brighter(0.2));
            
            legend.append("rect")
                .attr("x", 0)
                .attr("y", 0)
                .attr("width", width - margin.left - margin.right)
                .attr("height", 15)
                .attr("fill", "url(#heatmap-gradient)");
            
            legend.append("text")
                .attr("x", 0)
                .attr("y", -5)
                .attr("font-size", "10px")
                .attr("fill", "#5a5a5a")
                .text("增长率低");
            
            legend.append("text")
                .attr("x", width - margin.left - margin.right)
                .attr("y", -5)
                .attr("text-anchor", "end")
                .attr("font-size", "10px")
                .attr("fill", "#5a5a5a")
                .text("增长率高");
        };
        
        // 图表5：GDP与文化产业增速对比（雷达图）
        const drawChart5 = () => {
            const data = [
                {axis: "GDP总量", value: 5.2, max: 20},
                {axis: "第一产业", value: 3.8, max: 20},
                {axis: "第二产业", value: 4.8, max: 20},
                {axis: "第三产业", value: 5.7, max: 20},
                {axis: "文化产业", value: 7.1, max: 20}
            ];
            
            const container = d3.select("#chart5");
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height - 40;
            const radius = Math.min(width, height) / 2 - 30;
            
            const svg = container.append("svg")
                .attr("width", width)
                .attr("height", height)
                .append("g")
                .attr("transform", `translate(${width/2},${height/2})`);
            
            // 雷达图配置
            const levels = 5;
            const angleSlice = Math.PI * 2 / data.length;
            
            // 创建雷达网格
            for (let level = 0; level < levels; level++) {
                const levelFactor = radius * ((level + 1) / levels);
                
                svg.append("circle")
                    .attr("class", "radar-grid")
                    .attr("r", levelFactor)
                    .attr("fill", "none");
            }
            
            // 创建雷达轴
            for (let i = 0; i < data.length; i++) {
                const angle = angleSlice * i - Math.PI / 2;
                
                // 轴线
                svg.append("line")
                    .attr("class", "radar-axis")
                    .attr("x1", 0)
                    .attr("y1", 0)
                    .attr("x2", radius * Math.cos(angle))
                    .attr("y2", radius * Math.sin(angle));
                
                // 轴标签
                svg.append("text")
                    .attr("class", "radar-label")
                    .attr("x", (radius + 20) * Math.cos(angle))
                    .attr("y", (radius + 20) * Math.sin(angle))
                    .text(data[i].axis);
            }
            
            // 创建雷达区域
            const radarLine = d3.lineRadial()
                .angle((d, i) => angleSlice * i - Math.PI / 2)
                .radius(d => radius * (d.value / d.max))
                .curve(d3.curveLinearClosed);
            
            svg.append("path")
                .datum(data)
                .attr("class", "radar-area")
                .attr("d", radarLine);
            
            // 添加数据点
            svg.selectAll(".radar-point")
                .data(data)
                .enter()
                .append("circle")
                .attr("class", "radar-point")
                .attr("r", 4)
                .attr("cx", (d, i) => radius * (d.value / d.max) * Math.cos(angleSlice * i - Math.PI / 2))
                .attr("cy", (d, i) => radius * (d.value / d.max) * Math.sin(angleSlice * i - Math.PI / 2))
                .on("mouseover", function(event, d) {
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", .9);
                    tooltip.html(`${d.axis}<br>同比增长: ${d.value}%`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition()
                        .duration(500)
                        .style("opacity", 0);
                });
            
            // 添加数值标签
            svg.selectAll(".radar-value")
                .data(data)
                .enter()
                .append("text")
                .attr("class", "radar-label")
                .attr("x", (d, i) => (radius * (d.value / d.max) + 10) * Math.cos(angleSlice * i - Math.PI / 2))
                .attr("y", (d, i) => (radius * (d.value / d.max) + 10) * Math.sin(angleSlice * i - Math.PI / 2))
                .attr("text-anchor", "middle")
                .attr("font-size", "10px")
                .text(d => d.value + "%");
        };
        
        // 图表6：行业资产与营收关系（Three.js 3D气泡图）
        const drawChart6 = () => {
            const data = [
                {industry: "新闻信息服务", assets: 37652, revenue: 22276, growth: 8.6, color: colors.primary[0]},
                {industry: "内容创作生产", assets: 65356, revenue: 38877, growth: 8.4, color: colors.primary[1]},
                {industry: "创意设计服务", assets: 42115, revenue: 38900, growth: 7.2, color: colors.primary[2]},
                {industry: "文化传播渠道", assets: 27490, revenue: 19898, growth: 4.5, color: colors.primary[3]},
                {industry: "文化娱乐休闲服务", assets: 38430, revenue: 4227, growth: 1.2, color: colors.primary[4]},
                {industry: "文化辅助生产", assets: 42407, revenue: 26598, growth: 6.2, color: colors.accent[0]},
                {industry: "文化装备生产", assets: 7887, revenue: 7820, growth: 11.2, color: colors.accent[1]},
                {industry: "文化消费终端生产", assets: 23151, revenue: 31382, growth: 6.8, color: colors.accent[2]}
            ];
            
            const container = document.getElementById('chart6');
            const width = container.clientWidth;
            const height = container.clientHeight;
            
            // 创建场景
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0xf5f5f5);
            
            // 创建相机
            const camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
            camera.position.set(0, 20, 50);
            camera.lookAt(0, 0, 0);
            
            // 创建渲染器
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(width, height);
            container.appendChild(renderer.domElement);
            
            // 添加轨道控制器
            const controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            
            // 添加光源
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(10, 20, 10);
            scene.add(directionalLight);
            
            // 创建气泡
            const maxAssets = d3.max(data, d => d.assets);
            const maxRevenue = d3.max(data, d => d.revenue);
            const maxGrowth = d3.max(data, d => d.growth);
            
            data.forEach(d => {
                const size = (d.growth / maxGrowth) * 5 + 1;
                const geometry = new THREE.SphereGeometry(size, 32, 32);
                const material = new THREE.MeshPhongMaterial({ 
                    color: new THREE.Color(d.color),
                    specular: 0x111111,
                    shininess: 30,
                    transparent: true,
                    opacity: 0.8
                });
                const sphere = new THREE.Mesh(geometry, material);
                
                // 位置映射
                sphere.position.x = (d.assets / maxAssets) * 30 - 15;
                sphere.position.z = (d.revenue / maxRevenue) * 30 - 15;
                
                // 添加交互标签
                sphere.userData = {
                    industry: d.industry,
                    assets: d.assets,
                    revenue: d.revenue,
                    growth: d.growth
                };
                
                scene.add(sphere);
            });
            
            // 添加坐标轴辅助
            const axesHelper = new THREE.AxesHelper(20);
            scene.add(axesHelper);
            
            // 添加网格地面
            const gridHelper = new THREE.GridHelper(30, 30, 0x888888, 0xcccccc);
            scene.add(gridHelper);
            
            // 添加X轴标签
            const xLabelCanvas = document.createElement('canvas');
            xLabelCanvas.width = 128;
            xLabelCanvas.height = 64;
            const xLabelContext = xLabelCanvas.getContext('2d');
            xLabelContext.fillStyle = '#ffffff';
            xLabelContext.fillRect(0, 0, xLabelCanvas.width, xLabelCanvas.height);
            xLabelContext.fillStyle = '#333333';
            xLabelContext.font = '14px Arial';
            xLabelContext.textAlign = 'center';
            xLabelContext.fillText('资产总计(亿元)', xLabelCanvas.width/2, 32);
            
            const xLabelTexture = new THREE.CanvasTexture(xLabelCanvas);
            const xLabelMaterial = new THREE.SpriteMaterial({ map: xLabelTexture });
            const xLabel = new THREE.Sprite(xLabelMaterial);
            xLabel.position.set(0, -10, -20);
            xLabel.scale.set(10, 5, 1);
            scene.add(xLabel);
            
            // 添加Z轴标签
            const zLabelCanvas = document.createElement('canvas');
            zLabelCanvas.width = 128;
            zLabelCanvas.height = 64;
            const zLabelContext = zLabelCanvas.getContext('2d');
            zLabelContext.fillStyle = '#ffffff';
            zLabelContext.fillRect(0, 0, zLabelCanvas.width, zLabelCanvas.height);
            zLabelContext.fillStyle = '#333333';
            zLabelContext.font = '14px Arial';
            zLabelContext.textAlign = 'center';
            zLabelContext.fillText('营业收入(亿元)', zLabelCanvas.width/2, 32);
            
            const zLabelTexture = new THREE.CanvasTexture(zLabelCanvas);
            const zLabelMaterial = new THREE.SpriteMaterial({ map: zLabelTexture });
            const zLabel = new THREE.Sprite(zLabelMaterial);
            zLabel.position.set(-20, -10, 0);
            zLabel.scale.set(10, 5, 1);
            scene.add(zLabel);
            
            // 添加大小图例
            const sizeLegendCanvas = document.createElement('canvas');
            sizeLegendCanvas.width = 128;
            sizeLegendCanvas.height = 64;
            const sizeLegendContext = sizeLegendCanvas.getContext('2d');
            sizeLegendContext.fillStyle = '#ffffff';
            sizeLegendContext.fillRect(0, 0, sizeLegendCanvas.width, sizeLegendCanvas.height);
            sizeLegendContext.fillStyle = '#333333';
            sizeLegendContext.font = '12px Arial';
            sizeLegendContext.textAlign = 'center';
            sizeLegendContext.fillText('气泡大小表示增长率', sizeLegendCanvas.width/2, 20);
            sizeLegendContext.fillText('越大表示增长越快', sizeLegendCanvas.width/2, 40);
            
            const sizeLegendTexture = new THREE.CanvasTexture(sizeLegendCanvas);
            const sizeLegendMaterial = new THREE.SpriteMaterial({ map: sizeLegendTexture });
            const sizeLegend = new THREE.Sprite(sizeLegendMaterial);
            sizeLegend.position.set(20, 10, 0);
            sizeLegend.scale.set(10, 5, 1);
            scene.add(sizeLegend);
            
            // 鼠标交互
            const raycaster = new THREE.Raycaster();
            const mouse = new THREE.Vector2();
            let hoveredObject = null;
            
            container.addEventListener('mousemove', (event) => {
                // 计算鼠标位置归一化坐标
                mouse.x = (event.clientX - container.getBoundingClientRect().left) / container.clientWidth * 2 - 1;
                mouse.y = - (event.clientY - container.getBoundingClientRect().top) / container.clientHeight * 2 + 1;
                
                // 更新射线
                raycaster.setFromCamera(mouse, camera);
                
                // 计算相交对象
                const intersects = raycaster.intersectObjects(scene.children);
                
                if (intersects.length > 0 && intersects[0].object.userData.industry) {
                    if (hoveredObject !== intersects[0].object) {
                        // 恢复之前高亮的对象
                        if (hoveredObject) {
                            hoveredObject.material.color.set(hoveredObject.userData.color);
                            hoveredObject.scale.set(1, 1, 1);
                        }
                        
                        // 高亮新对象
                        hoveredObject = intersects[0].object;
                        hoveredObject.material.color.set(0xff0000);
                        hoveredObject.scale.set(1.2, 1.2, 1.2);
                        
                        // 显示工具提示
                        const data = hoveredObject.userData;
                        tooltip.transition()
                            .duration(200)
                            .style("opacity", .9);
                        tooltip.html(`${data.industry}<br>资产: ${data.assets.toLocaleString()}亿元<br>营收: ${data.revenue.toLocaleString()}亿元<br>增速: ${data.growth}%`)
                            .style("left", (event.pageX + 10) + "px")
                            .style("top", (event.pageY - 28) + "px");
                    }
                } else {
                    if (hoveredObject) {
                        hoveredObject.material.color.set(hoveredObject.userData.color);
                        hoveredObject.scale.set(1, 1, 1);
                        hoveredObject = null;
                        tooltip.transition()
                            .duration(500)
                            .style("opacity", 0);
                    }
                }
            });
            
            // 动画循环
            function animate() {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(scene, camera);
            }
            animate();
            
            // 响应式调整
            window.addEventListener('resize', () => {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
        };
        
        // 图表7：GDP季度增速趋势
        const drawChart7 = () => {
            const data = [
                {year: 2020, q1: -6.8, q2: 3.2, q3: 4.9},
                {year: 2021, q1: 18.9, q2: 8.1, q3: 5.5},
                {year: 2022, q1: 4.8, q2: 0.8, q3: 4.0},
                {year: 2023, q1: 4.7, q2: 6.5, q3: 5.0},
                {year: 2024, q1: 5.3, q2: 4.7, q3: 4.6},
                {year: 2025, q1: 5.4, q2: 5.2}
            ];
            
            const container = d3.select("#chart7");
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height - 40;
            const margin = {top: 20, right: 20, bottom: 40, left: 60};
            
            const svg = container.append("svg")
                .attr("width", width)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            // 转换数据为适合折线图的形式
            const quarters = ["q1", "q2", "q3"];
            const dataset = [];
            
            data.forEach(d => {
                quarters.forEach(q => {
                    if (d[q] !== undefined) {
                        dataset.push({
                            year: d.year,
                            quarter: q,
                            value: d[q],
                            label: `${d.year}年${q === "q1" ? "一季度" : q === "q2" ? "二季度" : "三季度"}`
                        });
                    }
                });
            });
            
            // X轴比例尺（时间）
            const x = d3.scalePoint()
                .domain(dataset.map(d => d.label))
                .range([0, width - margin.left - margin.right])
                .padding(0.5);
            
            // Y轴比例尺（增长率）
            const y = d3.scaleLinear()
                .domain([-10, 25])
                .range([height, 0]);
            
            // 添加折线
            const line = d3.line()
                .x(d => x(d.label))
                .y(d => y(d.value))
                .curve(d3.curveMonotoneX);
            
            svg.append("path")
                .datum(dataset)
                .attr("fill", "none")
                .attr("stroke", colors.accent[0])
                .attr("stroke-width", 3)
                .attr("d", line);
            
            // 添加数据点
            svg.selectAll("circle")
                .data(dataset)
                .enter()
                .append("circle")
                .attr("cx", d => x(d.label))
                .attr("cy", d => y(d.value))
                .attr("r", 5)
                .attr("fill", d => d.value < 0 ? colors.primary[3] : colors.primary[0])
                .attr("stroke", "#fff")
                .attr("stroke-width", 1)
                .on("mouseover", function(event, d) {
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", .9);
                    tooltip.html(`${d.label}<br>同比增长: ${d.value}%`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition()
                        .duration(500)
                        .style("opacity", 0);
                });
            
            // 添加数值标签
            svg.selectAll("text")
                .data(dataset)
                .enter()
                .append("text")
                .attr("x", d => x(d.label))
                .attr("y", d => y(d.value) - 15)
                .attr("text-anchor", "middle")
                .attr("font-size", "10px")
                .attr("fill", "#5a5a5a")
                .text(d => d.value + "%");
            
            // 添加X轴
            svg.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x))
                .selectAll("text")
                .attr("dy", "0.35em")
                .attr("dx", "-0.5em")
                .attr("transform", "rotate(-15)")
                .style("text-anchor", "end");
            
            // 添加Y轴
            svg.append("g")
                .call(d3.axisLeft(y).ticks(10).tickFormat(d => d + "%"));
            
            // 添加Y轴标签
            svg.append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", -margin.left + 10)
                .attr("x", -height/2)
                .attr("dy", "0.71em")
                .attr("text-anchor", "middle")
                .attr("fill", "#5a5a5a")
                .text("GDP同比增长率");
        };
        
        // 初始化所有图表
        window.addEventListener("load", () => {
            drawChart1();
            drawChart2();
            drawChart3();
            drawChart4();
            drawChart5();
            drawChart6();
            drawChart7();
        });
    </script>
</body>
</html>
