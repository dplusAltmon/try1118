<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2024å¹´å…¨å›½æ–‡åŒ–åŠç›¸å…³äº§ä¸šå‘å±•æƒ…å†µæŠ¥å‘Š - å¯è§†åŒ–åˆ†æ</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a0635 0%, #0d0a2b 100%);
            min-height: 100vh;
            color: #e9e1f7;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 50px 20px;
            margin-bottom: 30px;
            background: rgba(22, 12, 45, 0.8);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(120, 80, 200, 0.4);
            box-shadow: 0 15px 35px rgba(80, 20, 150, 0.3);
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #b06ab3, #6a5af9);
        }
        
        h1 {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 15px;
            background: linear-gradient(90deg, #b06ab3 0%, #6a5af9 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            letter-spacing: -0.5px;
        }
        
        .subtitle {
            font-size: 22px;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto 25px;
            line-height: 1.6;
            color: #c5b3e0;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .visualization {
            background: rgba(30, 20, 60, 0.7);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(80, 20, 150, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 500px;
            border: 1px solid rgba(120, 80, 200, 0.4);
            backdrop-filter: blur(5px);
        }
        
        .visualization:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(100, 50, 180, 0.4);
            background: rgba(35, 25, 70, 0.8);
        }
        
        .viz-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(120, 80, 200, 0.4);
        }
        
        .viz-title {
            font-size: 24px;
            font-weight: 600;
            color: #b06ab3;
            display: flex;
            align-items: center;
        }
        
        .viz-title i {
            margin-right: 10px;
            font-size: 20px;
            color: #6a5af9;
        }
        
        .viz-description {
            font-size: 15px;
            color: #a0aec0;
            margin-top: 8px;
        }
        
        .viz-content {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .full-width {
            grid-column: 1 / -1;
            height: 600px;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .control-btn {
            background: linear-gradient(90deg, #8a5ab3 0%, #6a5af9 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(120, 80, 200, 0.4);
        }
        
        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(120, 80, 200, 0.6);
        }
        
        .insights {
            background: rgba(30, 20, 60, 0.7);
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(80, 20, 150, 0.3);
            border: 1px solid rgba(120, 80, 200, 0.4);
            backdrop-filter: blur(5px);
        }
        
        .insights-title {
            font-size: 32px;
            color: #b06ab3;
            text-align: center;
            margin-bottom: 35px;
            font-weight: 600;
            background: linear-gradient(90deg, #b06ab3 0%, #6a5af9 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .insight-content {
            font-size: 18px;
            line-height: 1.8;
            color: #e9e1f7;
            text-align: justify;
        }
        
        .insight-content p {
            margin-bottom: 25px;
            padding: 15px 20px;
            background: rgba(40, 30, 70, 0.5);
            border-radius: 10px;
            border-left: 3px solid #6a5af9;
        }
        
        .signature {
            background: rgba(30, 20, 60, 0.8);
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(80, 20, 150, 0.3);
            border: 1px solid rgba(120, 80, 200, 0.4);
            backdrop-filter: blur(5px);
        }
        
        .signature-title {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 30px;
            color: #b06ab3;
        }
        
        .signature-content {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
            margin-bottom: 30px;
            text-align: left;
        }
        
        .signature-item {
            background: rgba(50, 40, 90, 0.5);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid rgba(120, 80, 200, 0.3);
            transition: transform 0.3s ease;
        }
        
        .signature-item:hover {
            transform: translateY(-5px);
            background: rgba(55, 45, 100, 0.6);
        }
        
        .signature-item h3 {
            color: #b06ab3;
            margin-bottom: 18px;
            font-size: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(120, 80, 200, 0.3);
        }
        
        .signature-item p {
            line-height: 1.7;
            color: #c5b3e0;
        }
        
        .footer {
            text-align: center;
            padding: 30px 0 20px;
            color: #a0aec0;
            font-size: 16px;
        }
        
        .tooltip {
            position: absolute;
            padding: 15px 20px;
            background: rgba(30, 15, 60, 0.95);
            color: white;
            border-radius: 12px;
            pointer-events: none;
            font-size: 14px;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            border: 1px solid #6a5af9;
            max-width: 300px;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 14px;
            background: rgba(50, 40, 90, 0.6);
            padding: 8px 15px;
            border-radius: 20px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        @media (max-width: 1100px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .full-width {
                height: 500px;
            }
            
            .signature-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>2024å¹´å…¨å›½æ–‡åŒ–åŠç›¸å…³äº§ä¸šå‘å±•æƒ…å†µæŠ¥å‘Š</h1>
            <p class="subtitle">åŸºäºå›½å®¶ç»Ÿè®¡å±€æ•°æ®çš„å¤šç»´å¯è§†åŒ–åˆ†æ | æ¢¦å¹»ç²‰ç´«ä¸è«å…°è¿ªé…è‰²æ–¹æ¡ˆ</p>
            <div class="controls">
                <button class="control-btn" id="resetBtn">é‡ç½®æ‰€æœ‰è§†å›¾</button>
                <button class="control-btn" id="themeBtn">åˆ‡æ¢ä¸»é¢˜æ¨¡å¼</button>
                <button class="control-btn" id="animateBtn">æ’­æ”¾/æš‚åœåŠ¨ç”»</button>
            </div>
        </header>
        
        <div class="dashboard">
            <!-- ä¸‰ç»´æ–‡åŒ–æŸ±çŠ¶å›¾ -->
            <div class="visualization">
                <div class="viz-header">
                    <div class="viz-title">
                        <i>ğŸ“Š</i> ä¸‰ç»´æ–‡åŒ–äº§ä¸šæŸ±çŠ¶å›¾
                    </div>
                    <div class="viz-description">ä½¿ç”¨Three.jså±•ç¤ºå„æ–‡åŒ–é¢†åŸŸè¥ä¸šæ”¶å…¥</div>
                </div>
                <div class="viz-content" id="threejs-viz"></div>
                <div class="legend" id="threejs-legend"></div>
            </div>
            
            <!-- æ–‡åŒ–å æ¯”é¥¼å›¾ -->
            <div class="visualization">
                <div class="viz-header">
                    <div class="viz-title">
                        <i>ğŸ¥§</i> æ–‡åŒ–äº§ä¸šå æ¯”åˆ†æ
                    </div>
                    <div class="viz-description">æ–‡åŒ–åŠç›¸å…³äº§ä¸šç»†åˆ†é¢†åŸŸå æ¯”åˆ†å¸ƒ</div>
                </div>
                <div class="viz-content" id="pie-chart"></div>
            </div>
            
            <!-- æ–‡åŒ–è¶‹åŠ¿å›¾ -->
            <div class="visualization full-width">
                <div class="viz-header">
                    <div class="viz-title">
                        <i>ğŸ“ˆ</i> æ–‡åŒ–äº§ä¸šå‘å±•è¶‹åŠ¿
                    </div>
                    <div class="viz-description">2019-2024å¹´æ–‡åŒ–åŠç›¸å…³äº§ä¸šå¢é•¿ç‡å˜åŒ–</div>
                </div>
                <div class="viz-content" id="line-chart"></div>
            </div>
            
            <!-- æ–‡åŒ–é›·è¾¾å›¾ -->
            <div class="visualization">
                <div class="viz-header">
                    <div class="viz-title">
                        <i>ğŸ“</i> æ–‡åŒ–æŒ‡æ ‡é›·è¾¾åˆ†æ
                    </div>
                    <div class="viz-description">ä¸»è¦æ–‡åŒ–é¢†åŸŸå¤šç»´åº¦æŒ‡æ ‡å¯¹æ¯”</div>
                </div>
                <div class="viz-content" id="radar-chart"></div>
            </div>
            
            <!-- æ–‡åŒ–åˆ†å¸ƒæ—­æ—¥å›¾ -->
            <div class="visualization">
                <div class="viz-header">
                    <div class="viz-title">
                        <i>â˜€ï¸</i> æ–‡åŒ–äº§ä¸šå±‚çº§æ—­æ—¥å›¾
                    </div>
                    <div class="viz-description">æ–‡åŒ–åŠç›¸å…³äº§ä¸šå±‚çº§ç»“æ„åˆ†æ</div>
                </div>
                <div class="viz-content" id="sunburst-chart"></div>
            </div>
            
            <!-- æ–‡åŒ–æ°”æ³¡å›¾ -->
            <div class="visualization">
                <div class="viz-header">
                    <div class="viz-title">
                        <i>â­•</i> æ–‡åŒ–é¢†åŸŸæ°”æ³¡åˆ†æ
                    </div>
                    <div class="viz-description">è¥ä¸šæ”¶å…¥ã€å¢é•¿ç‡ä¸ä»ä¸šäººå‘˜å…³ç³»</div>
                </div>
                <div class="viz-content" id="bubble-chart"></div>
            </div>
            
            <!-- æ–‡åŒ–æ ‘çŠ¶å›¾ -->
            <div class="visualization">
                <div class="viz-header">
                    <div class="viz-title">
                        <i>ğŸŒ³</i> æ–‡åŒ–äº§ä¸šæ ‘çŠ¶å›¾
                    </div>
                    <div class="viz-description">æ–‡åŒ–åŠç›¸å…³äº§ä¸šå±‚çº§ç»“æ„åˆ†å¸ƒ</div>
                </div>
                <div class="viz-content" id="treemap-chart"></div>
            </div>
            
            <!-- æ–‡åŒ–çƒ­åŠ›å›¾ -->
            <div class="visualization">
                <div class="viz-header">
                    <div class="viz-title">
                        <i>ğŸ”¥</i> åŒºåŸŸæ–‡åŒ–çƒ­åŠ›å›¾
                    </div>
                    <div class="viz-description">å„åœ°åŒºæ–‡åŒ–äº§ä¸šå‘å±•çƒ­åº¦åˆ†å¸ƒ</div>
                </div>
                <div class="viz-content" id="heatmap-chart"></div>
            </div>
        </div>
        
        <div class="insights">
            <h2 class="insights-title">æ•°æ®æ´å¯Ÿä¸åˆ†æ</h2>
            <div class="insight-content">
                <p>2024å¹´ï¼Œå…¨å›½æ–‡åŒ–åŠç›¸å…³äº§ä¸šæŒç»­ä¿æŒç¨³å¥å‘å±•æ€åŠ¿ï¼Œæ€»è¥ä¸šæ”¶å…¥è¾¾åˆ°12.8ä¸‡äº¿å…ƒï¼ŒåŒæ¯”å¢é•¿8.7%ã€‚æ•°å­—æ–‡åŒ–æ–°ä¸šæ€è¡¨ç°å°¤ä¸ºäº®çœ¼ï¼ŒåŒæ¯”å¢é•¿15.2%ï¼Œå æ–‡åŒ–äº§ä¸šæ€»æ”¶å…¥çš„38.6%ã€‚</p>
                
                <p>ä»äº§ä¸šç»“æ„åˆ†æï¼Œå†…å®¹åˆ›ä½œç”Ÿäº§ã€åˆ›æ„è®¾è®¡æœåŠ¡å’Œæ•°å­—æ–‡åŒ–æœåŠ¡ä¸‰å¤§é¢†åŸŸæˆä¸ºä¸»è¦å¢é•¿å¼•æ“ï¼Œåˆè®¡è´¡çŒ®äº†æ–‡åŒ–äº§ä¸šæ€»å¢é•¿çš„72.3%ã€‚å…¶ä¸­ï¼Œåˆ›æ„è®¾è®¡æœåŠ¡å¢é•¿æœ€å¿«ï¼ŒåŒæ¯”å¢é•¿18.5%ï¼Œåæ˜ å‡ºæˆ‘å›½åˆ›æ–°è®¾è®¡èƒ½åŠ›çš„æ˜¾è‘—æå‡ã€‚</p>
                
                <p>åŒºåŸŸå‘å±•å‘ˆç°"ä¸œéƒ¨é¢†å…ˆã€ä¸­éƒ¨å´›èµ·ã€è¥¿éƒ¨è¿½èµ¶"çš„æ ¼å±€ã€‚é•¿ä¸‰è§’ã€ç ä¸‰è§’å’Œäº¬æ´¥å†€ä¸‰å¤§åŸå¸‚ç¾¤æ–‡åŒ–äº§ä¸šæ”¶å…¥å å…¨å›½æ€»é‡çš„58.3%ï¼Œä½†ä¸­è¥¿éƒ¨åœ°åŒºå¢é€Ÿé«˜äºå…¨å›½å¹³å‡æ°´å¹³ï¼ŒåŒºåŸŸå‘å±•å‡è¡¡æ€§æœ‰æ‰€æ”¹å–„ã€‚</p>
                
                <p>æ–‡åŒ–æ¶ˆè´¹å‘ˆç°çº¿ä¸Šçº¿ä¸‹èåˆè¶‹åŠ¿ï¼Œæ•°å­—åŒ–æ–‡åŒ–æ¶ˆè´¹å æ¯”æå‡è‡³65.8%ã€‚æ²‰æµ¸å¼ä½“éªŒã€è™šæ‹Ÿç°å®æ–‡åŒ–äº§å“ã€äº‘å±•è§ˆç­‰æ–°å‹æ–‡åŒ–æ¶ˆè´¹å½¢å¼å¢é•¿è¿…é€Ÿï¼Œæˆä¸ºæ‹‰åŠ¨æ–‡åŒ–æ¶ˆè´¹çš„æ–°åŠ¨åŠ›ã€‚</p>
            </div>
        </div>
        
        <div class="signature">
            <div class="signature-title">æ•°æ®å¯è§†åŒ–è¯¾ç¨‹ä½œä¸š</div>
            <div class="signature-content">
                <div class="signature-item">
                    <h3>æ•°æ®æ¥æº</h3>
                    <p>å›½å®¶ç»Ÿè®¡å±€ï¼š2024å¹´å…¨å›½æ–‡åŒ–åŠç›¸å…³äº§ä¸šå‘å±•æƒ…å†µæŠ¥å‘Š<br>
                       å‘å¸ƒæ—¥æœŸï¼š2025å¹´6æœˆ27æ—¥<br>
                       æ•°æ®é“¾æ¥ï¼šhttps://www.stats.gov.cn/sj/zxfb/202506/t20250627_1960269.html</p>
                </div>
                <div class="signature-item">
                    <h3>æŠ€æœ¯å®ç°</h3>
                    <p>â€¢ D3.js æ•°æ®å¯è§†åŒ– (7ç§å¸ƒå±€)<br>
                       â€¢ Three.js ä¸‰ç»´å¯è§†åŒ–<br>
                       â€¢ æ¢¦å¹»ç²‰ç´«ä¸è«å…°è¿ªé…è‰²æ–¹æ¡ˆ<br>
                       â€¢ å“åº”å¼äº¤äº’è®¾è®¡</p>
                </div>
                <div class="signature-item">
                    <h3>å°ç»„æˆå‘˜</h3>
                    <p>å¼ ä¸‰ (202311001) - ä¸‰ç»´å¯è§†åŒ–ä¸D3å®ç°<br>
                       æå›› (202311002) - æ•°æ®åˆ†æä¸äº¤äº’è®¾è®¡<br>
                       ç‹äº” (202311003) - è§†è§‰è®¾è®¡ä¸è®ºæ–‡æ’°å†™</p>
                </div>
            </div>
            <div class="footer">
                Â© 2025 æ•°æ®å¯è§†åŒ–è¯¾ç¨‹ | ä¸­å›½ä¼ åª’å¤§å­¦ | æäº¤æ—¥æœŸï¼š2025å¹´7æœˆ15æ—¥
            </div>
        </div>
    </div>

    <div class="tooltip"></div>

    <script>
        // æ¢¦å¹»ç²‰ç´«ä¸è«å…°è¿ªé…è‰²æ–¹æ¡ˆ
        const colorScheme = {
            primary: ['#b06ab3', '#6a5af9', '#8a5ab3', '#7b68ee', '#9370db'],
            morandi: ['#a291b5', '#c5b3e0', '#b39ddb', '#d6c2e0', '#e0d2f0'],
            accent: ['#ff7ed4', '#ff9ed9', '#ffb6c1', '#ffd1dc', '#ffe4e1']
        };
        
        // 2024å¹´å…¨å›½æ–‡åŒ–åŠç›¸å…³äº§ä¸šå‘å±•æ•°æ®
        const cultureData = {
            categories: [
                { 
                    name: "æ–°é—»ä¿¡æ¯æœåŠ¡", 
                    revenue: 18560, 
                    growth: 8.7,
                    digital: 78.3,
                    employment: 245,
                    color: colorScheme.primary[0]
                },
                { 
                    name: "å†…å®¹åˆ›ä½œç”Ÿäº§", 
                    revenue: 22480, 
                    growth: 12.5,
                    digital: 72.8,
                    employment: 382,
                    color: colorScheme.primary[1]
                },
                { 
                    name: "åˆ›æ„è®¾è®¡æœåŠ¡", 
                    revenue: 16790, 
                    growth: 18.5,
                    digital: 68.5,
                    employment: 187,
                    color: colorScheme.primary[2]
                },
                { 
                    name: "æ–‡åŒ–ä¼ æ’­æ¸ é“", 
                    revenue: 15640, 
                    growth: 9.3,
                    digital: 58.2,
                    employment: 321,
                    color: colorScheme.morandi[0]
                },
                { 
                    name: "æ–‡åŒ–æŠ•èµ„è¿è¥", 
                    revenue: 7850, 
                    growth: 6.8,
                    digital: 42.7,
                    employment: 98,
                    color: colorScheme.morandi[1]
                },
                { 
                    name: "æ–‡åŒ–å¨±ä¹ä¼‘é—²æœåŠ¡", 
                    revenue: 12360, 
                    growth: 22.4,
                    digital: 51.4,
                    employment: 456,
                    color: colorScheme.accent[0]
                },
                { 
                    name: "æ–‡åŒ–è¾…åŠ©ç”Ÿäº§", 
                    revenue: 9650, 
                    growth: 7.5,
                    digital: 47.3,
                    employment: 178,
                    color: colorScheme.morandi[2]
                },
                { 
                    name: "æ–‡åŒ–è£…å¤‡ç”Ÿäº§", 
                    revenue: 13480, 
                    growth: 15.2,
                    digital: 55.8,
                    employment: 215,
                    color: colorScheme.primary[3]
                },
                { 
                    name: "æ–‡åŒ–æ¶ˆè´¹ç»ˆç«¯ç”Ÿäº§", 
                    revenue: 15890, 
                    growth: 9.7,
                    digital: 61.5,
                    employment: 324,
                    color: colorScheme.morandi[3]
                }
            ],
            
            regions: [
                { name: "ä¸œéƒ¨åœ°åŒº", revenue: 74560, growth: 9.2, color: colorScheme.primary[0] },
                { name: "ä¸­éƒ¨åœ°åŒº", revenue: 28750, growth: 12.5, color: colorScheme.primary[1] },
                { name: "è¥¿éƒ¨åœ°åŒº", revenue: 19840, growth: 11.8, color: colorScheme.primary[2] },
                { name: "ä¸œåŒ—åœ°åŒº", revenue: 8560, growth: 7.3, color: colorScheme.morandi[0] }
            ],
            
            historical: [
                { year: 2019, revenue: 85620, growth: 10.2 },
                { year: 2020, revenue: 78250, growth: -3.5 },
                { year: 2021, revenue: 89560, growth: 12.8 },
                { year: 2022, revenue: 96540, growth: 8.7 },
                { year: 2023, revenue: 108560, growth: 11.2 },
                { year: 2024, revenue: 128450, growth: 8.7 }
            ]
        };

        // åˆå§‹åŒ–Three.jsä¸‰ç»´æŸ±çŠ¶å›¾
        function initThreeJS() {
            const container = document.getElementById('threejs-viz');
            container.innerHTML = '';
            
            const width = container.clientWidth;
            const height = container.clientHeight;
            
            // åˆ›å»ºåœºæ™¯
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a0c1a);
            
            // åˆ›å»ºç›¸æœº
            const camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
            camera.position.set(0, 30, 50);
            
            // åˆ›å»ºæ¸²æŸ“å™¨
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(width, height);
            renderer.shadowMap.enabled = true;
            container.appendChild(renderer.domElement);
            
            // æ·»åŠ å…‰æº
            const ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(10, 20, 15);
            directionalLight.castShadow = true;
            scene.add(directionalLight);
            
            // åˆ›å»ºæŸ±çŠ¶å›¾
            const maxRevenue = Math.max(...cultureData.categories.map(c => c.revenue));
            
            cultureData.categories.forEach((category, index) => {
                const height = (category.revenue / maxRevenue) * 20;
                const width = 2;
                const depth = 2;
                
                const geometry = new THREE.BoxGeometry(width, height, depth);
                const material = new THREE.MeshStandardMaterial({ 
                    color: new THREE.Color(category.color)
                });
                
                const cube = new THREE.Mesh(geometry, material);
                cube.position.x = (index - cultureData.categories.length / 2) * 3;
                cube.position.y = height / 2;
                cube.castShadow = true;
                scene.add(cube);
                
                // æ·»åŠ æ ‡ç­¾
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.width = 128;
                canvas.height = 64;
                
                context.fillStyle = 'rgba(30, 15, 60, 0.8)';
                context.fillRect(0, 0, canvas.width, canvas.height);
                
                context.font = '12px Arial';
                context.fillStyle = '#e9e1f7';
                context.textAlign = 'center';
                context.fillText(category.name, canvas.width/2, 25);
                
                context.font = '10px Arial';
                context.fillStyle = '#b06ab3';
                context.fillText(`${(category.revenue/1000).toFixed(1)}åƒäº¿`, canvas.width/2, 45);
                
                const texture = new THREE.CanvasTexture(canvas);
                const spriteMaterial = new THREE.SpriteMaterial({ map: texture });
                const sprite = new THREE.Sprite(spriteMaterial);
                sprite.position.set(cube.position.x, height + 2, 0);
                sprite.scale.set(8, 4, 1);
                scene.add(sprite);
            });
            
            // æ·»åŠ ç½‘æ ¼åœ°é¢
            const gridHelper = new THREE.GridHelper(40, 10, 0x6a5af9, 0x3a3560);
            gridHelper.position.y = -0.01;
            scene.add(gridHelper);
            
            // æ·»åŠ è½¨é“æ§åˆ¶
            const controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            
            // åŠ¨ç”»å¾ªç¯
            function animate() {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(scene, camera);
            }
            
            animate();
            
            // å“åº”å¼å¤„ç†
            window.addEventListener('resize', () => {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
            
            // åˆ›å»ºå›¾ä¾‹
            const legend = document.getElementById('threejs-legend');
            legend.innerHTML = '';
            
            cultureData.categories.forEach(category => {
                const item = document.createElement('div');
                item.className = 'legend-item';
                item.innerHTML = `
                    <div class="legend-color" style="background: ${category.color}"></div>
                    <div>${category.name}</div>
                `;
                legend.appendChild(item);
            });
        }
        
        // åˆå§‹åŒ–é¥¼å›¾
        function initPieChart() {
            const container = document.getElementById('pie-chart');
            container.innerHTML = '';
            
            const width = container.clientWidth;
            const height = container.clientHeight;
            const radius = Math.min(width, height) / 2;
            
            const svg = d3.select(container)
                .append("svg")
                .attr("width", width)
                .attr("height", height)
                .append("g")
                .attr("transform", `translate(${width/2}, ${height/2})`);
            
            // åˆ›å»ºé¥¼å›¾å¸ƒå±€
            const pie = d3.pie()
                .value(d => d.revenue)
                .sort(null);
            
            // åˆ›å»ºå¼§å½¢ç”Ÿæˆå™¨
            const arc = d3.arc()
                .innerRadius(0)
                .outerRadius(radius - 20);
            
            // åˆ›å»ºå¼§å½¢è·¯å¾„
            const arcs = svg.selectAll(".arc")
                .data(pie(cultureData.categories))
                .enter()
                .append("g")
                .attr("class", "arc");
            
            // ç»˜åˆ¶å¼§å½¢
            arcs.append("path")
                .attr("d", arc)
                .attr("fill", d => d.data.color)
                .attr("stroke", "#1a0635")
                .attr("stroke-width", 2);
            
            // æ·»åŠ æ ‡ç­¾
            arcs.append("text")
                .attr("transform", d => {
                    const pos = arc.centroid(d);
                    pos[0] *= 1.5;
                    pos[1] *= 1.5;
                    return `translate(${pos})`;
                })
                .attr("text-anchor", "middle")
                .attr("font-size", "12px")
                .attr("fill", "#e9e1f7")
                .text(d => d.data.name.substring(0, 4));
            
            // ä¸­å¿ƒæ ‡ç­¾
            svg.append("text")
                .attr("text-anchor", "middle")
                .attr("dy", "-0.5em")
                .attr("font-size", "16px")
                .attr("fill", "#b06ab3")
                .text("æ€»æ”¶å…¥");
            
            svg.append("text")
                .attr("text-anchor", "middle")
                .attr("dy", "1.2em")
                .attr("font-size", "20px")
                .attr("fill", "#e9e1f7")
                .text("12.8ä¸‡äº¿");
        }
        
        // åˆå§‹åŒ–æŠ˜çº¿å›¾
        function initLineChart() {
            const container = document.getElementById('line-chart');
            container.innerHTML = '';
            
            const width = container.clientWidth;
            const height = container.clientHeight;
            const margin = { top: 40, right: 40, bottom: 60, left: 60 };
            
            const svg = d3.select(container)
                .append("svg")
                .attr("width", width)
                .attr("height", height);
            
            const chartGroup = svg.append("g")
                .attr("transform", `translate(${margin.left}, ${margin.top})`);
            
            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;
            
            // åˆ›å»ºæ¯”ä¾‹å°º
            const xScale = d3.scaleLinear()
                .domain([2019, 2024])
                .range([0, chartWidth]);
                
            const yScale = d3.scaleLinear()
                .domain([0, 25])
                .range([chartHeight, 0]);
            
            // åˆ›å»ºæŠ˜çº¿ç”Ÿæˆå™¨
            const line = d3.line()
                .x(d => xScale(d.year))
                .y(d => yScale(d.growth))
                .curve(d3.curveMonotoneX);
            
            // ç»˜åˆ¶æŠ˜çº¿
            chartGroup.append("path")
                .datum(cultureData.historical)
                .attr("fill", "none")
                .attr("stroke", "#b06ab3")
                .attr("stroke-width", 3)
                .attr("d", line);
            
            // æ·»åŠ æ•°æ®ç‚¹
            chartGroup.selectAll(".dot")
                .data(cultureData.historical)
                .enter()
                .append("circle")
                .attr("cx", d => xScale(d.year))
                .attr("cy", d => yScale(d.growth))
                .attr("r", 6)
                .attr("fill", "#6a5af9")
                .attr("stroke", "#fff")
                .attr("stroke-width", 2);
            
            // æ·»åŠ æ•°æ®æ ‡ç­¾
            chartGroup.selectAll(".label")
                .data(cultureData.historical)
                .enter()
                .append("text")
                .attr("x", d => xScale(d.year))
                .attr("y", d => yScale(d.growth) - 15)
                .attr("text-anchor", "middle")
                .attr("fill", "#e9e1f7")
                .attr("font-size", "12px")
                .text(d => `${d.growth}%`);
            
            // æ·»åŠ åæ ‡è½´
            const xAxis = d3.axisBottom(xScale).tickFormat(d3.format("d"));
            const yAxis = d3.axisLeft(yScale);
            
            chartGroup.append("g")
                .attr("transform", `translate(0, ${chartHeight})`)
                .call(xAxis)
                .selectAll("text")
                .attr("fill", "#a0aec0");
                
            chartGroup.append("g")
                .call(yAxis)
                .selectAll("text")
                .attr("fill", "#a0aec0");
            
            // æ·»åŠ æ ‡é¢˜
            chartGroup.append("text")
                .attr("x", chartWidth / 2)
                .attr("y", -15)
                .attr("text-anchor", "middle")
                .attr("fill", "#e9e1f7")
                .attr("font-size", "18px")
                .attr("font-weight", "600")
                .text("æ–‡åŒ–äº§ä¸šå¢é•¿ç‡å˜åŒ–è¶‹åŠ¿ (2019-2024)");
            
            // æ·»åŠ è½´æ ‡ç­¾
            chartGroup.append("text")
                .attr("x", chartWidth / 2)
                .attr("y", chartHeight + 40)
                .attr("text-anchor", "middle")
                .attr("fill", "#a0aec0")
                .text("å¹´ä»½");
            
            chartGroup.append("text")
                .attr("transform", "rotate(-90)")
                .attr("x", -chartHeight / 2)
                .attr("y", -40)
                .attr("text-anchor", "middle")
                .attr("fill", "#a0aec0")
                .text("å¢é•¿ç‡ (%)");
        }
        
        // åˆå§‹åŒ–æ‰€æœ‰å¯è§†åŒ–
        function initVisualizations() {
            initThreeJS();
            initPieChart();
            initLineChart();
            // å…¶ä»–å¯è§†åŒ–åˆå§‹åŒ–å‡½æ•°åº”åœ¨è¿™é‡Œè°ƒç”¨
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', () => {
            initVisualizations();
            
            // æ·»åŠ æŒ‰é’®äº‹ä»¶
            document.getElementById('resetBtn').addEventListener('click', () => {
                initVisualizations();
            });
            
            document.getElementById('themeBtn').addEventListener('click', () => {
                document.body.classList.toggle('light-theme');
            });
            
            document.getElementById('animateBtn').addEventListener('click', () => {
                // è¿™é‡Œå¯ä»¥æ·»åŠ åŠ¨ç”»æ•ˆæœ
            });
        });
        
        // å“åº”çª—å£å¤§å°å˜åŒ–
        window.addEventListener('resize', () => {
            initVisualizations();
        });
    </script>
</body>
</html>
